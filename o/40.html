<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>13. Наибольшая общая подпоследовательность</title></head><body><h1>13. Наибольшая общая подпоследовательность</h1>
<div class="page_content_main"><p>Рассмотрим две строки (или числовые последовательности) — <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.194ex" viewBox="0 -817.1 750.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">A</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.048ex" viewBox="0 -754.4 759.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">B</script>. Пусть первая строка состоит из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">n</script> символов <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.33ex" height="2.048ex" viewBox="0 -566.3 4447.7 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1150" y="0"></use><g transform="translate(2489,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-91">a_0…a_{n-1}</script>, вторая строка состоит из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.611ex" viewBox="0 -566.3 878.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-92">m</script> символов <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.322ex" height="2.631ex" viewBox="0 -817.1 4444.3 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1050" y="0"></use><g transform="translate(2389,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">b_0…b_{m-1}</script>. Подпоследовательностью данной строки (последовательности) называется некоторое подмножество символов исходной строки, следующих в том же порядке, в котором они идут в исходной строке, но не обязательно подряд. Если в строке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">n</script> символов, то у нее <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.381ex" height="2.194ex" viewBox="0 -817.1 1025.1 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="707" y="557"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-95">2^n</script> различных подпоследовательностей: каждый из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">n</script> символов строки может либо входить, либо не входить в любую выбранную подпоследовательность. Пустая подпоследовательность не содержит ни одного элемента и также является подпоследовательностью любой строки.</p>
<p><span style="text-decoration: underline;" data-mce-mark="1">Рассмотрим задачу</span> — для двух данных строк найти такую строку наибольшей длины, которая была бы подпоследовательностью каждой из них. Например, если A=«abcabaac», B=«baccbca» то у строк A и B них есть общая подпоследовательность длины 4, например, «acba» или «acbc».</p>
<p>Данную задачу можно решить <em>перебором</em>&nbsp;— например, перебрав все <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mi>n</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.381ex" height="2.194ex" viewBox="0 -817.1 1025.1 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="707" y="557"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-97">2^n</script> подпоследовательностей первой строки и для каждой их них проверив, является ли она подпоследовательностью второй строки. Но при помощи динамического программирования эту же задачу можно решить за сложность <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.018ex" height="2.776ex" viewBox="0 -817.1 3021.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMATHI-6E" x="1153" y="0"></use><use xlink:href="#MJMATHI-6D" x="1753" y="0"></use><use xlink:href="#MJMAIN-29" x="2632" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">O(nm)</script>.</p>
<p>Рассмотрим последние символы данных строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.549ex" height="2.048ex" viewBox="0 -566.3 1958.5 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-99">a_{n-1}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.631ex" viewBox="0 -817.1 2055.1 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">b_{m-1}</script>. Если эти символы совпадают, то они обязательно войдут последними символами и в наибольшую общую подпоследовательность данных строк. Тогда можно свести задачу нахождения наибольшей общей подпоследовательности для строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.172ex" height="2.631ex" viewBox="0 -817.1 6532.3 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="1028" y="0"></use><g transform="translate(2084,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3234" y="0"></use><g transform="translate(4573,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-101">A=a_0…a_{n-1}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.185ex" height="2.631ex" viewBox="0 -817.1 6537.9 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="1037" y="0"></use><g transform="translate(2093,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3143" y="0"></use><g transform="translate(4482,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-102">B=b_0…b_{m-1}</script> к задаче нахождения наибольшей общей подпоследовательности для строк, полученных отбрасыванием от данных строк последнего символа, то есть для <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.33ex" height="2.048ex" viewBox="0 -566.3 4447.7 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1150" y="0"></use><g transform="translate(2489,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-103">a_0…a_{n-2}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.322ex" height="2.631ex" viewBox="0 -817.1 4444.3 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1050" y="0"></use><g transform="translate(2389,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1657" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-104">b_0…b_{m-2}</script>. Затем к ответу для «укороченных» строк добавим последние (равные) символы исходных строк (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.549ex" height="2.048ex" viewBox="0 -566.3 1958.5 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-105">a_{n-1}</script> или <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.631ex" viewBox="0 -817.1 2055.1 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-106">b_{m-1}</script>) и получим ответ для исходных строк.</p>
<p>Если же последние символы исходных строк не совпадают, то эти символы (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.549ex" height="2.048ex" viewBox="0 -566.3 1958.5 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-107">a_{n-1}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.773ex" height="2.631ex" viewBox="0 -817.1 2055.1 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-108">b_{m-1}</script>) не могут одновременно входить в наибольшую общую подпоследовательность, поэтому можно один из них отбросить. Тогда задача сводится к нахождению наибольшей общей подпоследовательности для одного из двух случаев - для строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.33ex" height="2.048ex" viewBox="0 -566.3 4447.7 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1150" y="0"></use><g transform="translate(2489,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-109">a_0…a_{n-2}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.322ex" height="2.631ex" viewBox="0 -817.1 4444.3 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1050" y="0"></use><g transform="translate(2389,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1657" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-110">b_0…b_{m-1}</script> или для строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.33ex" height="2.048ex" viewBox="0 -566.3 4447.7 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1150" y="0"></use><g transform="translate(2489,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-111">a_0…a_{n-1}</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.322ex" height="2.631ex" viewBox="0 -817.1 4444.3 1132.6" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use><use xlink:href="#MJMAIN-2026" x="1050" y="0"></use><g transform="translate(2389,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="878" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1657" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-112">b_0…b_{m-2}</script>.</p>
<p>Мы научились сводить задачу нахождения наибольшей общей подпоследовательности двух строк к меньшей задаче - нахождения наибольшей общей подпоследовательности для строк, полученных отбрасыванием последних символов от исходных строк, то есть для префиксов исходных строк. Для дальнейшего решения задачи будем следовать принципу построения решения при помощи динамического программирования.</p>
<p>Рассмотрим префикс <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.428ex" height="2.339ex" viewBox="0 -879.8 1045.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1061" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-113">A'</script> первой строки из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">i</script> символов: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.438ex" height="2.776ex" viewBox="0 -879.8 6646.8 1195.3" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1061" y="513"></use><use xlink:href="#MJMAIN-3D" x="1323" y="0"></use><g transform="translate(2379,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3529" y="0"></use><g transform="translate(4868,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo>′</mo></msup><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">A'=a_0…a_{i-1}</script> и префикс <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>B</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.449ex" height="2.339ex" viewBox="0 -879.8 1054.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1074" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-116">B'</script> второй строки из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-117">j</script> символов: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>B</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>&amp;#x2026;</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.104ex" height="2.922ex" viewBox="0 -879.8 6503.2 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1074" y="513"></use><use xlink:href="#MJMAIN-3D" x="1332" y="0"></use><g transform="translate(2388,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="607" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3438" y="0"></use><g transform="translate(4777,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo>′</mo></msup><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>…</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-118">B'=b_0…b_{j-1}</script>. В терминах срезов языка Питон можно считать, что <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>A</mi><mo stretchy=&quot;false&quot;>[</mo><mo>:</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.658ex" height="2.922ex" viewBox="0 -879.8 4588.6 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1061" y="513"></use><use xlink:href="#MJMAIN-3D" x="1323" y="0"></use><use xlink:href="#MJMATHI-41" x="2379" y="0"></use><use xlink:href="#MJMAIN-5B" x="3129" y="0"></use><use xlink:href="#MJMAIN-3A" x="3408" y="0"></use><use xlink:href="#MJMATHI-69" x="3964" y="0"></use><use xlink:href="#MJMAIN-5D" x="4310" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo>′</mo></msup><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mo>:</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-119">A'=A[:i]</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>B</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>B</mi><mo stretchy=&quot;false&quot;>[</mo><mo>:</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.855ex" height="2.922ex" viewBox="0 -879.8 4673.6 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1074" y="513"></use><use xlink:href="#MJMAIN-3D" x="1332" y="0"></use><use xlink:href="#MJMATHI-42" x="2388" y="0"></use><use xlink:href="#MJMAIN-5B" x="3147" y="0"></use><use xlink:href="#MJMAIN-3A" x="3426" y="0"></use><use xlink:href="#MJMATHI-6A" x="3982" y="0"></use><use xlink:href="#MJMAIN-5D" x="4395" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo>′</mo></msup><mo>=</mo><mi>B</mi><mo stretchy="false">[</mo><mo>:</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-120">B'=B[:j]</script>. Обозначим через <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.345ex" height="2.776ex" viewBox="0 -817.1 2731.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">F(i, j)</script> длину наибольшей общей подпоследовательности для <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.428ex" height="2.339ex" viewBox="0 -879.8 1045.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1061" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-122">A'</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>B</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.449ex" height="2.339ex" viewBox="0 -879.8 1054.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1074" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-123">B'</script>.</p>
<p>Теперь выпишем <em>рекуррентные соотношения</em>. Они зависят от того, совпадают ли последние символы рассматриваемых строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.428ex" height="2.339ex" viewBox="0 -879.8 1045.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1061" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-124">A'</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>B</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.449ex" height="2.339ex" viewBox="0 -879.8 1054.3 1007.2" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="1074" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>B</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-125">B'</script>. Если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.236ex" height="2.776ex" viewBox="0 -817.1 4837.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="2055" y="0"></use><g transform="translate(3112,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">a_{i-1}=b_{j-1}</script>, то тогда <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.796ex" height="2.776ex" viewBox="0 -817.1 11967.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use><use xlink:href="#MJMAIN-3D" x="3009" y="0"></use><use xlink:href="#MJMATHI-46" x="4065" y="0"></use><use xlink:href="#MJMAIN-28" x="4815" y="0"></use><use xlink:href="#MJMATHI-69" x="5204" y="0"></use><use xlink:href="#MJMAIN-2212" x="5772" y="0"></use><use xlink:href="#MJMAIN-31" x="6773" y="0"></use><use xlink:href="#MJMAIN-2C" x="7273" y="0"></use><use xlink:href="#MJMATHI-6A" x="7718" y="0"></use><use xlink:href="#MJMAIN-2212" x="8353" y="0"></use><use xlink:href="#MJMAIN-31" x="9354" y="0"></use><use xlink:href="#MJMAIN-29" x="9854" y="0"></use><use xlink:href="#MJMAIN-2B" x="10466" y="0"></use><use xlink:href="#MJMAIN-31" x="11467" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-127">F(i, j) = F(i-1,j-1) + 1</script> - нужно решить задачу для строк, полученных отбрасыванием последних символов рассматриваемых строк и добавить 1 символ к ответу. В противном случае нужно рассмотреть два случая: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.347ex" height="2.776ex" viewBox="0 -817.1 4455.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2212" x="1706" y="0"></use><use xlink:href="#MJMAIN-31" x="2707" y="0"></use><use xlink:href="#MJMAIN-2C" x="3207" y="0"></use><use xlink:href="#MJMATHI-6A" x="3653" y="0"></use><use xlink:href="#MJMAIN-29" x="4065" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-128">F(i - 1, j)</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.347ex" height="2.776ex" viewBox="0 -817.1 4455.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-2212" x="2564" y="0"></use><use xlink:href="#MJMAIN-31" x="3565" y="0"></use><use xlink:href="#MJMAIN-29" x="4065" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-129">F(i, j -1)</script>, которые соответствуют отбрасыванию по одному символу от конца каждой из рассматриваемых строк. В этом случае <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.566ex" height="2.776ex" viewBox="0 -817.1 15313.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use><use xlink:href="#MJMAIN-3D" x="3009" y="0"></use><g transform="translate(4065,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="5928" y="0"></use><use xlink:href="#MJMATHI-46" x="6317" y="0"></use><use xlink:href="#MJMAIN-28" x="7067" y="0"></use><use xlink:href="#MJMATHI-69" x="7456" y="0"></use><use xlink:href="#MJMAIN-2212" x="8024" y="0"></use><use xlink:href="#MJMAIN-31" x="9025" y="0"></use><use xlink:href="#MJMAIN-2C" x="9525" y="0"></use><use xlink:href="#MJMATHI-6A" x="9970" y="0"></use><use xlink:href="#MJMAIN-29" x="10383" y="0"></use><use xlink:href="#MJMAIN-2C" x="10772" y="0"></use><use xlink:href="#MJMAIN-28" x="11218" y="0"></use><use xlink:href="#MJMATHI-69" x="11607" y="0"></use><use xlink:href="#MJMAIN-2C" x="11953" y="0"></use><use xlink:href="#MJMATHI-6A" x="12398" y="0"></use><use xlink:href="#MJMAIN-2212" x="13032" y="0"></use><use xlink:href="#MJMAIN-31" x="14033" y="0"></use><use xlink:href="#MJMAIN-29" x="14534" y="0"></use><use xlink:href="#MJMAIN-29" x="14923" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-130">F(i, j) = \max(F(i - 1, j), (i, j -1))</script>.</p>
<p>Начальные значения функции <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.741ex" height="2.048ex" viewBox="0 -754.4 749.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">F</script> задаются просто: если одна из строк - пустая, то общая подпоследовательность также пустая, то есть имеет длину 0: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.613ex" height="2.776ex" viewBox="0 -817.1 8874.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMAIN-30" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1639" y="0"></use><use xlink:href="#MJMATHI-6A" x="2084" y="0"></use><use xlink:href="#MJMAIN-29" x="2497" y="0"></use><use xlink:href="#MJMAIN-3D" x="3164" y="0"></use><use xlink:href="#MJMATHI-46" x="4220" y="0"></use><use xlink:href="#MJMAIN-28" x="4970" y="0"></use><use xlink:href="#MJMATHI-69" x="5359" y="0"></use><use xlink:href="#MJMAIN-2C" x="5705" y="0"></use><use xlink:href="#MJMAIN-30" x="6150" y="0"></use><use xlink:href="#MJMAIN-29" x="6650" y="0"></use><use xlink:href="#MJMAIN-3D" x="7318" y="0"></use><use xlink:href="#MJMAIN-30" x="8374" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-132">F(0, j) = F(i, 0) = 0</script>.</p>
<p>Далее необходимо завести двумерный массив размером <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.9ex" height="2.776ex" viewBox="0 -817.1 7706.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-6E" x="389" y="0"></use><use xlink:href="#MJMAIN-2B" x="1212" y="0"></use><use xlink:href="#MJMAIN-31" x="2212" y="0"></use><use xlink:href="#MJMAIN-29" x="2713" y="0"></use><use xlink:href="#MJMAIN-D7" x="3325" y="0"></use><use xlink:href="#MJMAIN-28" x="4325" y="0"></use><use xlink:href="#MJMATHI-6D" x="4715" y="0"></use><use xlink:href="#MJMAIN-2B" x="5816" y="0"></use><use xlink:href="#MJMAIN-31" x="6816" y="0"></use><use xlink:href="#MJMAIN-29" x="7317" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">(n+1)\times(m+1)</script> и заполнить его значениями по указанным рекуррентным соотношениям. Сначала весь массив заполним нулями (что задаст граничные значения), затем двумя вложенными циклами по <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">i</script> и по <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">j</script> заполним оставшуюся часть массива:</p>
<div class="page_code_style">
<p>n = len(A)<br> m = len(B)<br> F = [[0] * (m + 1)&nbsp;for i in range(n + 1)]<br> for i in range(1, n + 1):<br>&nbsp; &nbsp; for j in range(1, m + 1):<br>&nbsp; &nbsp; &nbsp; &nbsp; if A[i - 1] == B[j - 1]:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; F[i][j] = F[i - 1][j - 1] + 1 <br>&nbsp; &nbsp; &nbsp; &nbsp; else: <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; F[i][j] = max(F[i - 1][j], F[i][j - 1]) <br>print(F[n][m])</p>
</div>
<p>В таблице ниже приведен пример заполнения массива для строки «abcabaac» и «baccbca». Длина наибольшей общей подпоследовательности для данных строк равна 4.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="44">
<p align="center"><strong>&nbsp;</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>&nbsp;</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>b</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>c</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>c</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>b</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>c</strong></p>
</td>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>&nbsp;</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>b</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>c</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>b</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>a</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
</tr>
<tr>
<td valign="top" width="44">
<p align="center"><strong>c</strong></p>
</td>
<td valign="top" width="44">
<p align="center">0</p>
</td>
<td valign="top" width="44">
<p align="center">1</p>
</td>
<td valign="top" width="44">
<p align="center">2</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">3</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
<td valign="top" width="44">
<p align="center">4</p>
</td>
</tr>
</tbody>
</table>
<p>Этот код находит длину наибольшей общей подпоследовательности. Для нахождения самой общей подпоследовательности необходимо восстановить ответ. Для этого выполним «обратный проход» по массиву <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.741ex" height="2.048ex" viewBox="0 -754.4 749.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">F</script> начиная с последнего элемента. В каждой рассматриваемой ячейке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.089ex" height="2.776ex" viewBox="0 -817.1 2621.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-5D" x="1373" y="0"></use><use xlink:href="#MJMAIN-5B" x="1652" y="0"></use><use xlink:href="#MJMATHI-6A" x="1930" y="0"></use><use xlink:href="#MJMAIN-5D" x="2343" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-137">F[i][j]</script> выясним, как было получено значение в этой ячейке. Это зависит от последних символов рассматриваемых префиксов. Если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.236ex" height="2.776ex" viewBox="0 -817.1 4837.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="2055" y="0"></use><g transform="translate(3112,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-138">a_{i-1}=b_{j-1}</script>, то тогда ответ для элемента <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.089ex" height="2.776ex" viewBox="0 -817.1 2621.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-5D" x="1373" y="0"></use><use xlink:href="#MJMAIN-5B" x="1652" y="0"></use><use xlink:href="#MJMATHI-6A" x="1930" y="0"></use><use xlink:href="#MJMAIN-5D" x="2343" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-139">F[i][j]</script> получен из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.094ex" height="2.776ex" viewBox="0 -817.1 6068.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-2212" x="1595" y="0"></use><use xlink:href="#MJMAIN-31" x="2596" y="0"></use><use xlink:href="#MJMAIN-5D" x="3096" y="0"></use><use xlink:href="#MJMAIN-5B" x="3375" y="0"></use><use xlink:href="#MJMATHI-6A" x="3653" y="0"></use><use xlink:href="#MJMAIN-2212" x="4288" y="0"></use><use xlink:href="#MJMAIN-31" x="5289" y="0"></use><use xlink:href="#MJMAIN-5D" x="5789" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-140">F[i-1][j-1]</script> добавлением 1, поэтому перейдем к элементу <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.094ex" height="2.776ex" viewBox="0 -817.1 6068.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-2212" x="1595" y="0"></use><use xlink:href="#MJMAIN-31" x="2596" y="0"></use><use xlink:href="#MJMAIN-5D" x="3096" y="0"></use><use xlink:href="#MJMAIN-5B" x="3375" y="0"></use><use xlink:href="#MJMATHI-6A" x="3653" y="0"></use><use xlink:href="#MJMAIN-2212" x="4288" y="0"></use><use xlink:href="#MJMAIN-31" x="5289" y="0"></use><use xlink:href="#MJMAIN-5D" x="5789" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-141">F[i-1][j-1]</script>, а к ответу добавим символ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.236ex" height="2.776ex" viewBox="0 -817.1 4837.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="2055" y="0"></use><g transform="translate(3112,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-142">a_{i-1}=b_{j-1}</script>. Иначе нужно перейти к тому элементу <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.092ex" height="2.776ex" viewBox="0 -817.1 4344.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-2212" x="1595" y="0"></use><use xlink:href="#MJMAIN-31" x="2596" y="0"></use><use xlink:href="#MJMAIN-5D" x="3096" y="0"></use><use xlink:href="#MJMAIN-5B" x="3375" y="0"></use><use xlink:href="#MJMATHI-6A" x="3653" y="0"></use><use xlink:href="#MJMAIN-5D" x="4066" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-143">F[i-1][j]</script> или <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.092ex" height="2.776ex" viewBox="0 -817.1 4344.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-5D" x="1373" y="0"></use><use xlink:href="#MJMAIN-5B" x="1652" y="0"></use><use xlink:href="#MJMATHI-6A" x="1930" y="0"></use><use xlink:href="#MJMAIN-2212" x="2565" y="0"></use><use xlink:href="#MJMAIN-31" x="3565" y="0"></use><use xlink:href="#MJMAIN-5D" x="4066" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-144">F[i][j-1]</script>, значение в котором совпадает со значением <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.089ex" height="2.776ex" viewBox="0 -817.1 2621.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1028" y="0"></use><use xlink:href="#MJMAIN-5D" x="1373" y="0"></use><use xlink:href="#MJMAIN-5B" x="1652" y="0"></use><use xlink:href="#MJMATHI-6A" x="1930" y="0"></use><use xlink:href="#MJMAIN-5D" x="2343" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-145">F[i][j]</script>. &nbsp;</p>
<p><em>Алгоритм восстановления ответа</em> записан ниже:</p>
<div class="page_code_style">
<p>Ans = []<br> i = n<br> j = m<br> while i &gt; 0 and j &gt; 0:<br>&nbsp; &nbsp; if A[i - 1] == B[j - 1]:<br>&nbsp; &nbsp; &nbsp; &nbsp; Ans.append(A[i - 1])<br>&nbsp; &nbsp; &nbsp; &nbsp; i -= 1<br>&nbsp; &nbsp; &nbsp; &nbsp; j -= 1<br>&nbsp; &nbsp; elif F[i - 1][j] == F[i][j]:<br>&nbsp; &nbsp; &nbsp; &nbsp; i -= 1 <br>&nbsp; &nbsp; else: <br>&nbsp; &nbsp; &nbsp; &nbsp; j -= 1 <br>Ans = Ans[::-1]</p>
</div></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>