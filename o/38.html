<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>13. Динамическое программирование на подотрезках</title></head><body><h1>13. Динамическое программирование на подотрезках</h1>
<div class="page_content_main"><p>Рассмотрим следующую задачу. Пусть есть некоторая строка, нужно вычеркнуть из нее наименьшее число символов, чтобы невычеркнутые символы образовывали палиндром.</p>
<p>Иными словами, из данной строки нужно выбрать подпоследовательность наибольшей длины (т.е. некоторое число элементов, сохраняя их порядок, но не обязательно идущих подряд), образующую палиндром.</p>
<p>Пусть длина исходной строки равна <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-361-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-361">n</script>, символы строки индексируются начиная с нуля. Рассмотрим следующую функцию динамического программирования:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-362-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.882ex" height="2.776ex" viewBox="0 -817.1 2532.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-6A" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2143" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-362">f(i, j)</script> — длина максимальной подпоследовательности-палиндрома, которую можно получить из строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-363-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.213ex" height="2.776ex" viewBox="0 -817.1 2674.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-2E" x="1093" y="0"></use><use xlink:href="#MJMAIN-2E" x="1538" y="0"></use><use xlink:href="#MJMATHI-6A" x="1983" y="0"></use><use xlink:href="#MJMAIN-5D" x="2396" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-363">s[i..j]</script>, то есть из подстроки из символов с индексами от <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-364-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-364">i</script> до <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-365-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-365">j</script> (включительно). При этом <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-366-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn><mo>&amp;#x2A7D;</mo><mi>i</mi><mo>&amp;#x2A7D;</mo><mi>j</mi><mo>&amp;#x003C;</mo><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.613ex" height="2.485ex" viewBox="0 -754.4 5861.2 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-30" x="0" y="0"></use><use xlink:href="#MJAMS-2A7D" x="778" y="0"></use><use xlink:href="#MJMATHI-69" x="1834" y="0"></use><use xlink:href="#MJAMS-2A7D" x="2457" y="0"></use><use xlink:href="#MJMATHI-6A" x="3514" y="0"></use><use xlink:href="#MJMAIN-3C" x="4204" y="0"></use><use xlink:href="#MJMATHI-6E" x="5260" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>j</mi><mo>&lt;</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-366">0\le i\le j \lt n</script>, то есть функция определена для каждой подстроки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-367-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.213ex" height="2.776ex" viewBox="0 -817.1 2674.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-2E" x="1093" y="0"></use><use xlink:href="#MJMAIN-2E" x="1538" y="0"></use><use xlink:href="#MJMATHI-6A" x="1983" y="0"></use><use xlink:href="#MJMAIN-5D" x="2396" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-367">s[i..j]</script> исходной строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-368-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.611ex" viewBox="0 -566.3 469.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-368">s</script>. Такой тип динамического программирования называется динамическим программированием на подотрезках.</p>
<p>При этом отметим, что <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-369-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.988ex" height="2.776ex" viewBox="0 -817.1 4300.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-69" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2076" y="0"></use><use xlink:href="#MJMAIN-3D" x="2743" y="0"></use><use xlink:href="#MJMAIN-31" x="3799" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-369">f(i, i) = 1</script> (подстрока из одного символа уже палиндром), а вот <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-370-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.73ex" height="2.776ex" viewBox="0 -817.1 4189.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-69" x="1730" y="0"></use><use xlink:href="#MJMAIN-2B" x="2298" y="0"></use><use xlink:href="#MJMAIN-31" x="3299" y="0"></use><use xlink:href="#MJMAIN-29" x="3799" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-370">f(i, i + 1)</script> может быть равно 1 (если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-371-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2260;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.475ex" height="2.776ex" viewBox="0 -817.1 5801.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1093" y="0"></use><use xlink:href="#MJMAIN-2260" x="1649" y="0"></use><use xlink:href="#MJMATHI-73" x="2706" y="0"></use><use xlink:href="#MJMAIN-5B" x="3175" y="0"></use><use xlink:href="#MJMATHI-69" x="3454" y="0"></use><use xlink:href="#MJMAIN-2B" x="4021" y="0"></use><use xlink:href="#MJMAIN-31" x="5022" y="0"></use><use xlink:href="#MJMAIN-5D" x="5523" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>≠</mo><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-371">s[i]\ne s[i+1]</script>) или 2 (если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-372-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.475ex" height="2.776ex" viewBox="0 -817.1 5801.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1093" y="0"></use><use xlink:href="#MJMAIN-3D" x="1649" y="0"></use><use xlink:href="#MJMATHI-73" x="2706" y="0"></use><use xlink:href="#MJMAIN-5B" x="3175" y="0"></use><use xlink:href="#MJMATHI-69" x="3454" y="0"></use><use xlink:href="#MJMAIN-2B" x="4021" y="0"></use><use xlink:href="#MJMAIN-31" x="5022" y="0"></use><use xlink:href="#MJMAIN-5D" x="5523" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-372">s[i]=s[i+1]</script>).</p>
<p>Также удобно считать, что в вырожденных случаях <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-373-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mo>&amp;#x003E;</mo><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.859ex" height="2.485ex" viewBox="0 -754.4 2092.1 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use><use xlink:href="#MJMAIN-3E" x="623" y="0"></use><use xlink:href="#MJMATHI-6A" x="1679" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>&gt;</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-373">i\gt j</script> значение <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-374-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.143ex" height="2.776ex" viewBox="0 -817.1 4367.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-6A" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2143" y="0"></use><use xlink:href="#MJMAIN-3D" x="2810" y="0"></use><use xlink:href="#MJMAIN-30" x="3866" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-374">f(i, j) = 0</script>, т.к. рассматриваемая подстрока пустая.</p>
<p>Выведем рекуррентное соотношение для <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-375-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.882ex" height="2.776ex" viewBox="0 -817.1 2532.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-6A" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2143" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-375">f(i, j)</script>. Если символы <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-376-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.187ex" height="2.776ex" viewBox="0 -817.1 1372 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1093" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-376">s[i]</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-377-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.342ex" height="2.776ex" viewBox="0 -817.1 1439 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-6A" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1160" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-377">s[j]</script> равны, то включим их оба в выбранную подпоследовательность, а между ними вставим наибольшую подпоследовательность-палиндром между ними, ее длина равна <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-378-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.888ex" height="2.776ex" viewBox="0 -817.1 5979.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2B" x="1507" y="0"></use><use xlink:href="#MJMAIN-31" x="2508" y="0"></use><use xlink:href="#MJMAIN-2C" x="3008" y="0"></use><use xlink:href="#MJMATHI-6A" x="3454" y="0"></use><use xlink:href="#MJMAIN-2212" x="4088" y="0"></use><use xlink:href="#MJMAIN-31" x="5089" y="0"></use><use xlink:href="#MJMAIN-29" x="5590" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-378">f(i+1, j - 1)</script>.&nbsp;То есть в этом случае <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-379-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.872ex" height="2.776ex" viewBox="0 -817.1 11569.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-6A" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2143" y="0"></use><use xlink:href="#MJMAIN-3D" x="2810" y="0"></use><use xlink:href="#MJMAIN-32" x="3866" y="0"></use><use xlink:href="#MJMAIN-2B" x="4589" y="0"></use><use xlink:href="#MJMATHI-66" x="5590" y="0"></use><use xlink:href="#MJMAIN-28" x="6140" y="0"></use><use xlink:href="#MJMATHI-69" x="6530" y="0"></use><use xlink:href="#MJMAIN-2B" x="7097" y="0"></use><use xlink:href="#MJMAIN-31" x="8098" y="0"></use><use xlink:href="#MJMAIN-2C" x="8599" y="0"></use><use xlink:href="#MJMATHI-6A" x="9044" y="0"></use><use xlink:href="#MJMAIN-2212" x="9679" y="0"></use><use xlink:href="#MJMAIN-31" x="10679" y="0"></use><use xlink:href="#MJMAIN-29" x="11180" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-379">f(i, j) = 2 + f(i + 1, j - 1)</script>.</p>
<p>Если же <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-380-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2260;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.627ex" height="2.776ex" viewBox="0 -817.1 4145.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1093" y="0"></use><use xlink:href="#MJMAIN-2260" x="1649" y="0"></use><use xlink:href="#MJMATHI-73" x="2706" y="0"></use><use xlink:href="#MJMAIN-5B" x="3175" y="0"></use><use xlink:href="#MJMATHI-6A" x="3454" y="0"></use><use xlink:href="#MJMAIN-5D" x="3866" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>≠</mo><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-380">s[i] \ne s[j]</script>, то символы <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-381-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.187ex" height="2.776ex" viewBox="0 -817.1 1372 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1093" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-381">s[i]</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-382-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.342ex" height="2.776ex" viewBox="0 -817.1 1439 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-6A" x="748" y="0"></use><use xlink:href="#MJMAIN-5D" x="1160" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-382">s[j]</script> не могут одновременно входить в подпоследовательность-палиндром, значит, один из них обязательно нужно выбросить.</p>
<p>В этом случае задача сводится либо к подстроке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-383-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>&amp;#x2026;</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.645ex" height="2.776ex" viewBox="0 -817.1 5013.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-2B" x="1315" y="0"></use><use xlink:href="#MJMAIN-31" x="2316" y="0"></use><use xlink:href="#MJMAIN-2026" x="2983" y="0"></use><use xlink:href="#MJMATHI-6A" x="4322" y="0"></use><use xlink:href="#MJMAIN-5D" x="4735" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>…</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-383">s[i + 1…j]</script>, либо <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-384-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2026;</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.645ex" height="2.776ex" viewBox="0 -817.1 5013.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="469" y="0"></use><use xlink:href="#MJMATHI-69" x="748" y="0"></use><use xlink:href="#MJMAIN-2026" x="1260" y="0"></use><use xlink:href="#MJMATHI-6A" x="2599" y="0"></use><use xlink:href="#MJMAIN-2212" x="3234" y="0"></use><use xlink:href="#MJMAIN-31" x="4234" y="0"></use><use xlink:href="#MJMAIN-5D" x="4735" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>…</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-384">s[i…j - 1]</script>. Выберем из них наибольший вариант, то есть в этом случае <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-385-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.92ex" height="2.776ex" viewBox="0 -817.1 15465.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="550" y="0"></use><use xlink:href="#MJMATHI-69" x="940" y="0"></use><use xlink:href="#MJMAIN-2C" x="1285" y="0"></use><use xlink:href="#MJMATHI-6A" x="1730" y="0"></use><use xlink:href="#MJMAIN-29" x="2143" y="0"></use><use xlink:href="#MJMAIN-3D" x="2810" y="0"></use><g transform="translate(3866,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="5729" y="0"></use><use xlink:href="#MJMATHI-66" x="6118" y="0"></use><use xlink:href="#MJMAIN-28" x="6669" y="0"></use><use xlink:href="#MJMATHI-69" x="7058" y="0"></use><use xlink:href="#MJMAIN-2B" x="7626" y="0"></use><use xlink:href="#MJMAIN-31" x="8627" y="0"></use><use xlink:href="#MJMAIN-2C" x="9127" y="0"></use><use xlink:href="#MJMATHI-6A" x="9572" y="0"></use><use xlink:href="#MJMAIN-29" x="9985" y="0"></use><use xlink:href="#MJMAIN-2C" x="10374" y="0"></use><use xlink:href="#MJMATHI-66" x="10820" y="0"></use><use xlink:href="#MJMAIN-28" x="11370" y="0"></use><use xlink:href="#MJMATHI-69" x="11760" y="0"></use><use xlink:href="#MJMAIN-2C" x="12105" y="0"></use><use xlink:href="#MJMATHI-6A" x="12550" y="0"></use><use xlink:href="#MJMAIN-2212" x="13185" y="0"></use><use xlink:href="#MJMAIN-31" x="14186" y="0"></use><use xlink:href="#MJMAIN-29" x="14686" y="0"></use><use xlink:href="#MJMAIN-29" x="15076" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-385">f(i, j) = \max(f(i + 1, j), f(i, j - 1))</script>.</p>
<p>Теперь для нахождения ответа необходимо организовать заполнение двумерного массива f значениями так, чтобы при рассмотрении отрезка <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-386-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.088ex" height="2.776ex" viewBox="0 -817.1 1760.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-5B" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="278" y="0"></use><use xlink:href="#MJMAIN-2C" x="624" y="0"></use><use xlink:href="#MJMATHI-6A" x="1069" y="0"></use><use xlink:href="#MJMAIN-5D" x="1481" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-386">[i, j]</script> все значения на вложенных в него подотрезках уже были бы вычислены. Это удобно делать при помощи двух вложенных циклов - первый цикл по возрастанию правой границы <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-387-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-387">j</script>, второй вложенный цикл - по убыванию левой границы <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-388-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-388">i</script> от <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-389-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-389">j</script> до нуля.</p>
<div class="page_code_style">
<p>vector&lt;vector&lt;int&gt; &gt; f(n, vector&lt;short int&gt;(n));<br>for (int j = 0; j &lt; n; ++j)<br>{<br>&nbsp;&nbsp;&nbsp; f[j][j] = 1;<br>&nbsp;&nbsp;&nbsp; for (int i = j - 1; i &gt;= 0; --i)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (s[i] == s[j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; f[i][j] = 2 + f[i + 1][j - 1];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; f[i][j] = max(f[i + 1][j], f[i][j - 1]);<br>}</p>
</div>
<p>Ответом (длиной максимальной подпоследовательности-палиндрома) является значение <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-390-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.426ex" height="2.776ex" viewBox="0 -817.1 4488.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-66" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="550" y="0"></use><use xlink:href="#MJMAIN-30" x="829" y="0"></use><use xlink:href="#MJMAIN-5D" x="1329" y="0"></use><use xlink:href="#MJMAIN-5B" x="1608" y="0"></use><use xlink:href="#MJMATHI-6E" x="1886" y="0"></use><use xlink:href="#MJMAIN-2212" x="2709" y="0"></use><use xlink:href="#MJMAIN-31" x="3709" y="0"></use><use xlink:href="#MJMAIN-5D" x="4210" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-390">f[0][n - 1]</script>.</p>
<p>Необходимо также уметь восстанавливать ответ - то есть находить не только длину подпоследовательности-палиндрома, но и сам палиндром.</p>
<p>Сделаем это при помощи рекурсивной функции, у которой также два параметра - первый и последний символ подстроки, для которой восстанавливается ответ.</p>
<div class="page_code_style">
<p>string ans(int i, int j)<br>{<br>&nbsp;&nbsp;&nbsp; if (i &gt; j)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "";<br>&nbsp;&nbsp;&nbsp; else if (i == j)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return s[i];<br>&nbsp;&nbsp;&nbsp; else if (s[i] == s[j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return s[i] + ans(i + 1, j - 1) + s[j];<br>&nbsp;&nbsp;&nbsp; else if (f[i + 1][j] &gt; f[i][j - 1])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ans(i + 1, j);<br>&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ans(i, j - 1);<br>}</p>
</div>
<p>Для построения ответа необходимо вызвать функцию ans(0, n - 1).</p></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>