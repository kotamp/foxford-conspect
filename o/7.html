<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>3. Ввод в языке C. Функция scanf.</title></head><body><h1>3. Ввод в языке C. Функция scanf.</h1>
<div class="page_content_main"><h1>Функция scanf</h1>
<p>Для считывания данных в языке C используется функция scanf. Ее использование похоже на функцию prinf - сначала задается форматная строка, потом передаются переменные, в которые необходимо записать результат. Например, для считывания двух целых чисел функция вызывается так:</p>
<p><span class="page_code_style">scanf("%d%d", &amp;a, &amp;b);</span></p>
<p>Основное отличие функции scanf в том, что при считывании чисел (или значений типа char) ей необходимо передавать <strong>адреса</strong> переменных (в языке C все параметры передаются по значению, поэтому чтобы функция scanf могла модифицировать переменную, необходимо передать в функцию адрес этой переменной). Поэтому перед названиями переменных мы пишем знак амперсанда ("&amp;").</p>
<p>В функции scanf могут быть явно записаны какие-то символы, кроме форматных строк. Например, вызов</p>
<p><span class="page_code_style">scanf("%d:%d") </span></p>
<p>можно использовать для считывания времени, заданного в виде hh:mm - функция считает число, затем символ двоеточия, затем опять число.</p>
<p>Если в форматной строке встречается пробел, то он означает, что будет считано любое число пробельных символов, возможно даже нулевое.</p><h1>Особенности считывания чисел</h1>
<p>Функция <span class="page_code_style">scanf</span> корректно считывает целые числа, если они&nbsp; начинаются с символа 0, или со знака "+". То есть числа "+123" или "0123" будут корректно считаны по форматной строке "%d", никаких дополнительных параметров задавать не нужно.</p>
<p>Также при считывании чисел игнорируются пробелы перед числом. Это означает, что вызов</p>
<p><span class="page_code_style">scanf("%d:%d", &amp;a, &amp;b) </span>сможет корректно считать время, заданное в формате hh:mm при наличии пробела после двоеточия (такая запись успешно считает строки "12:34", "01:02",&nbsp; "01:␣23" или "␣01:␣23", поскольку дается указание считать число, затем сразу же двоеточие, затем - число, перед которым могут быть пробелы). Но такая запись не считает выражение, например, вида "01␣:␣23", поскольку после первого числа сразу должно идти двоеточие.</p>
<p>Чтобы считать записать вида "01␣:␣23" можно использовать форматную строку "%d :%d", причем пробел в форматной строке может означать и отсутствие пробелов.</p><h1>Возможные форматные символы</h1>
<p>Возможные форматные символы функции <span class="page_code_style">scanf</span> для разных типов данных в целом соответствуют форматным символам для функции <span class="page_code_style">printf</span>, но имеют меньше различных модификаторов.</p>
<table border="0">
<tbody>
<tr>
<td>Форматная<br>строка</td>
<td>Соответствующий ей тип</td>
</tr>
<tr>
<td><strong>%hhd</strong></td>
<td>Считать число (десятичное) и записать его в переменную типа char (для unsigned char нужно использовать %hhu)</td>
</tr>
<tr>
<td><strong>%hd</strong></td>
<td>short int (для unsigned short int нужно использовать %hu)</td>
</tr>
<tr>
<td><strong>%d</strong></td>
<td>int (для unsigned int нужно использовать %u)</td>
</tr>
<tr>
<td><strong>%ld</strong></td>
<td>long int (для unsigned long int нужно использовать %lu)</td>
</tr>
<tr>
<td><strong>%lld</strong></td>
<td>long long int (для unsigned long long int нужно использовать %llu)</td>
</tr>
<tr>
<td><strong>%f</strong></td>
<td>float</td>
</tr>
<tr>
<td><strong>%lf</strong></td>
<td>double</td>
</tr>
<tr>
<td><strong>%Lf</strong></td>
<td>long double</td>
</tr>
<tr>
<td><strong>%с</strong></td>
<td>char. Считывается один символ, он может быть пробелом или символом конца строки.</td>
</tr>
<tr>
<td><strong>%s</strong></td>
<td>Считывается последовательность непробельных символов (строка), записывается в C-строку (типа char * или char[])</td>
</tr>
</tbody>
</table><h1>Особенность считывание символов</h1>
<p>Считывание одного символа "%c" считывает из потока ввода следующий символ, он может быть в том числе и пробельным символом, а также символом конца строки. Но если в форматной строке перед "%c" поставить пробел, то поскольку пробел в форматной строке обозначает последовательность пробельных символов любой длины, то в этом случае будет считан следующий непробельный символ.</p><h1>Особенность считывания строк</h1>
<p>При считывании строки результат записывается в С-строку, которая представляет собой массив символов (или указатель типа <span class="page_code_style">char *</span> с выделенной памятью). Поскольку строка в языке C является адресом (указателем) в памяти, где хранится начало строки символов, то передавать в функцию <span class="page_code_style">scanf</span> нужно имя переменной без указания амперсанда.</p>
<p>Например,</p>
<div class="page_code_style">
<p>char s[101];<br>scanf("%s", s);</p>
</div>
<p>Функция <span class="page_code_style">scanf</span> читает строку до первого пробельного символа, также она пропускает предшествующие пробелы, то есть она записывает следующее слово целиком составленное из непробельных символов.</p>
<p>Иногда бывает полезно считать всю строку целиком вместе с пробелами до конца строки. Для этого используется функция <span class="page_code_style">gets</span>. Например:</p>
<div class="page_code_style">
<p><span class="page_code_style">gets(s);</span></p>
</div>
<p>Функция <span class="page_code_style">gets</span> считается опасной и не рекомендуется для использования, так как она не контролирует количество считанных символов и не учитывает длину передаваемой строки, что может привести к записи данных за пределами строки.</p>
<p>Вместо нее рекомендуется использование функции <span class="page_code_style">fgets</span>, у которой три параметра - строка для записи результата, размер строки и файловый поток, из которого читаются данные. Например:</p>
<p><span class="page_code_style">fgets(s, 101, stdin);</span></p>
<p>В данном случае мы использовали <span class="page_code_style">stdin</span> для чтения со стандартного ввода.</p>
<p>Не следует забывать, что в языке C в конец строки добавляется нулевой символ для обозначения конца строки. То есть если необходимо считать строку, в которой может быть 4 символа, то для нее нужно создать массив <span class="page_code_style">char[5]</span>, и функции <span class="page_code_style">fgets</span> нужно передавать число, не меньшее 5.</p><h1>Возвращаемое значение</h1>
<p>Функция <span class="page_code_style">scanf</span> возвращает значение, равное числу успешно считанных и записанных в переданные параметры значений, что можно использовать для анализа входных данных.</p>
<p>Например, пусть вызвали <span class="page_code_style">scanf("%d:%d", &amp;a, &amp;b)</span>.</p>
<p>Тогда при вводе строки "12:34" функция <span class="page_code_style">scanf</span> считает два числа, запишет их в переменные a и b и вернет значение 2. А при вводе "12 34" будет считано только одно число, поскольку после него должно идти двоеточие, то второе число считано не будет и функция <span class="page_code_style">scanf</span> вернет значение 1.</p></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>