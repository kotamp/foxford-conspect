<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>13. Одномерное динамическое программирование: наилучший способ</title></head><body><h1>13. Одномерное динамическое программирование: наилучший способ</h1>
<div class="page_content_main"><h2>ЗАДАЧА О КУЗНЕЧИКЕ СО СТОИМОСТЯМИ</h2>
<p>Пусть кузнечик прыгает на одну или две точки вперед, а за прыжок в каждую точку необходимо заплатить определенную стоимость, различную для различных точек. Стоимость прыжка в точку i задается значением Price[i] списка Price. Необходимо найти минимальную стоимость маршрута кузнечика из точки 0 в точку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">n</script>.</p>
<p>На этот раз нам необходимо модифицировать определение&nbsp;<em>целевой функции</em>. Пусть <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.97ex" height="2.776ex" viewBox="0 -817.1 2140 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-6E" x="1150" y="0"></use><use xlink:href="#MJMAIN-29" x="1750" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">C(n)</script> — минимальная стоимость пути из 0 в <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">n</script>. Выведем рекуррентное соотношение для <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.97ex" height="2.776ex" viewBox="0 -817.1 2140 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-6E" x="1150" y="0"></use><use xlink:href="#MJMAIN-29" x="1750" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-34">C(n)</script>. Чтобы попасть в точку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">n</script> мы должны попасть в точку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.194ex" viewBox="0 -754.4 2323.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="822" y="0"></use><use xlink:href="#MJMAIN-31" x="1823" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-36">n-1</script> или <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.194ex" viewBox="0 -754.4 2323.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="822" y="0"></use><use xlink:href="#MJMAIN-32" x="1823" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-37">n-2</script>. Минимальные стоимости этих маршрутов будут равны <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.973ex" height="2.776ex" viewBox="0 -817.1 3863.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-6E" x="1150" y="0"></use><use xlink:href="#MJMAIN-2212" x="1972" y="0"></use><use xlink:href="#MJMAIN-31" x="2973" y="0"></use><use xlink:href="#MJMAIN-29" x="3473" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">C(n-1)</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.973ex" height="2.776ex" viewBox="0 -817.1 3863.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-6E" x="1150" y="0"></use><use xlink:href="#MJMAIN-2212" x="1972" y="0"></use><use xlink:href="#MJMAIN-32" x="2973" y="0"></use><use xlink:href="#MJMAIN-29" x="3473" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">C(n - 2)</script> соответственно, к ним придется добавить значение Price[n] за прыжок в клетку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">n</script>. Но из двух клеток <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.194ex" viewBox="0 -754.4 2323.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="822" y="0"></use><use xlink:href="#MJMAIN-31" x="1823" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-41">n-1</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.194ex" viewBox="0 -754.4 2323.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="822" y="0"></use><use xlink:href="#MJMAIN-32" x="1823" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-42">n-2</script> нужно выбрать тот маршрут, который имеет наименьшую стоимость.&nbsp;</p>
<p>Получили рекуррентное соотношение:</p>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.112ex" height="2.776ex" viewBox="0 -817.1 19423.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-6E" x="1150" y="0"></use><use xlink:href="#MJMAIN-29" x="1750" y="0"></use><use xlink:href="#MJMAIN-3D" x="2417" y="0"></use><g transform="translate(3474,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-69" x="833" y="0"></use><use xlink:href="#MJMAIN-6E" x="1112" y="0"></use></g><use xlink:href="#MJMAIN-28" x="5142" y="0"></use><use xlink:href="#MJMATHI-43" x="5532" y="0"></use><use xlink:href="#MJMAIN-28" x="6292" y="0"></use><use xlink:href="#MJMATHI-6E" x="6682" y="0"></use><use xlink:href="#MJMAIN-2212" x="7504" y="0"></use><use xlink:href="#MJMAIN-31" x="8505" y="0"></use><use xlink:href="#MJMAIN-29" x="9006" y="0"></use><use xlink:href="#MJMAIN-2C" x="9395" y="0"></use><use xlink:href="#MJMATHI-43" x="9840" y="0"></use><use xlink:href="#MJMAIN-28" x="10601" y="0"></use><use xlink:href="#MJMATHI-6E" x="10990" y="0"></use><use xlink:href="#MJMAIN-2212" x="11813" y="0"></use><use xlink:href="#MJMAIN-32" x="12814" y="0"></use><use xlink:href="#MJMAIN-29" x="13314" y="0"></use><use xlink:href="#MJMAIN-29" x="13704" y="0"></use><use xlink:href="#MJMAIN-2B" x="14315" y="0"></use><use xlink:href="#MJMATHI-50" x="15316" y="0"></use><use xlink:href="#MJMATHI-72" x="16068" y="0"></use><use xlink:href="#MJMATHI-69" x="16519" y="0"></use><use xlink:href="#MJMATHI-63" x="16865" y="0"></use><use xlink:href="#MJMATHI-65" x="17298" y="0"></use><use xlink:href="#MJMAIN-28" x="17765" y="0"></use><use xlink:href="#MJMATHI-6E" x="18154" y="0"></use><use xlink:href="#MJMAIN-29" x="18755" y="0"></use><use xlink:href="#MJMAIN-2E" x="19144" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">min</mo><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">C(n) = \min(C(n-1), C(n-2)) + Price(n).</script></p></div>
<p>Вычислить значение целевой функции также лучше при помощи динамического программирования, а не рекурсии:</p>
<div class="toggle_element">
<h3 class="toggle_header">Пример на языке Python</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>C = [0] * (n + 1)<br>C[1] = Price[1]<br>for i in range(2, n + 1):<br> &nbsp; &nbsp;С[i] = min(C[i — 1], C[i — 2]) + Price[i]</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<div class="toggle_element">
<h3 class="toggle_header">ПРимер на языке Pascal</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>var<br> &nbsp;C, Price: array[0..100] of longint;<br> &nbsp;i, n: longint;<br>begin<br> &nbsp;readln(n);<br> &nbsp;for i := 1 to n do<br> &nbsp; &nbsp;read(Price[i]);<br> &nbsp;for i := 0 to n do<br> &nbsp; &nbsp;C[i] := 0;<br> &nbsp;C[1] := Price[1];<br> &nbsp;for i := 2 to n do<br> &nbsp; &nbsp;C[i] := min(C[i - 1], C[i - 2]) + Price[i];<br> &nbsp;writeln(C[n]); &nbsp;<br>end.</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<p>&nbsp;После выполнения этого цикла в списке С будет записана минимальная стоимость маршрута для всех точек от 0 до <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">n</script>.</p>
<h2>ВОССТАНОВЛЕНИЕ ОТВЕТА</h2>
<p>Но помимо нахождения наименьшей стоимости маршрута, разумеется, хотелось бы найти и сам маршрут минимальной &nbsp;стоимости. Такая задача называется задачей «восстановления ответа».&nbsp;</p>
<p>Для восстановления ответа будем для каждой точки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">i</script> запоминать номер точки Prev[i], из которой кузнечик попал в точку i, если он будет передвигаться по пути минимальной стоимости. То есть Prev[i] — это точка, предшествующая точке с номером i на пути минимальной стоимости (также говорят, что Prev — это массив предшественников). Как определить Prev[i]? Если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;lt;</mo><mi>C</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>2</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.829ex" height="2.776ex" viewBox="0 -817.1 8106.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="760" y="0"></use><use xlink:href="#MJMATHI-69" x="1039" y="0"></use><use xlink:href="#MJMAIN-2212" x="1606" y="0"></use><use xlink:href="#MJMAIN-31" x="2607" y="0"></use><use xlink:href="#MJMAIN-5D" x="3107" y="0"></use><use xlink:href="#MJMAIN-3C" x="3664" y="0"></use><use xlink:href="#MJMATHI-43" x="4720" y="0"></use><use xlink:href="#MJMAIN-5B" x="5481" y="0"></use><use xlink:href="#MJMATHI-69" x="5759" y="0"></use><use xlink:href="#MJMAIN-2212" x="6327" y="0"></use><use xlink:href="#MJMAIN-32" x="7327" y="0"></use><use xlink:href="#MJMAIN-5D" x="7828" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>&lt;</mo><mi>C</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-46">C[i-1] < C[i-2]</script>, то кузнечик попал в точку i из точки i -1, поэтому Prev[i] = i - 1, иначе Prev[i] = i - 2. Модифицируем алгоритмы вычисления значений целевой функции, одновременно вычисляя значения Prev[i].</p>
<div class="toggle_element">
<h3 class="toggle_header">Пример программы на языке Python:</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>C = [0] * (n + 1)<br>C[1] = Price[1]<br>Prev[1] = 0<br>for i in range(2, n + 1):<br> &nbsp; &nbsp;if C[i — 1] &lt; C[i — 2]:<br> &nbsp; &nbsp; &nbsp; &nbsp;C[i] = C[i — 1] + Price[i]<br> &nbsp; &nbsp; &nbsp; &nbsp;Prev[i] = i — 1<br> &nbsp; &nbsp;else:<br> &nbsp; &nbsp; &nbsp; &nbsp;C[i] = C[i — 2] + Price[i]<br> &nbsp; &nbsp; &nbsp; &nbsp;Prev[i] = i — 2</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<div class="toggle_element">
<h3 class="toggle_header">Пример программы на языке Pascal:</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>var<br> &nbsp;C, Price, Prev: array[0..100] of longint;<br> &nbsp;j, i, n: longint;<br>begin<br> &nbsp;readln(n);<br> &nbsp;for i := 1 to n do<br> &nbsp; &nbsp;read(Price[i]);<br> &nbsp;for i := 0 to n do<br> &nbsp; &nbsp;C[i] := 0;<br> &nbsp;C[1] := Price[1];<br> &nbsp;Prev[1] := 0;<br> &nbsp;for i := 2 to n do<br> &nbsp; &nbsp;if C[i - 1] &lt; C[i - 2] then begin<br> &nbsp; &nbsp; &nbsp;C[i] := C[i - 1] + Price[i];<br> &nbsp; &nbsp; &nbsp;Prev[i] := i - 1;<br> &nbsp; &nbsp;end else begin<br> &nbsp; &nbsp; &nbsp;C[i] := C[i - 2] + Price[i];<br> &nbsp; &nbsp; &nbsp;Prev[i] := i - 2;<br> &nbsp; &nbsp;end;<br>end.</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<p>&nbsp;Теперь для восстановления пути необходимо начать с точки n и переходить от каждой точки к ее предшественнику, пока путь не дойдет до начальной точки с номером 0. Номера всех вершин будем добавлять в список (массив) Path.</p>
<div class="toggle_element">
<h3 class="toggle_header">Пример программы на языке Python:</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>Path = []<br>i = n<br>while i &gt; 0:<br> &nbsp; &nbsp;Path.append(i)<br> &nbsp; &nbsp;i = Prev[i]<br>Path.append(0)<br>Path = Path[::-1]</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<div class="toggle_element">
<h3 class="toggle_header">Пример программы на языке Pascal:</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>&nbsp;i := n;<br> &nbsp;j := 1;<br> &nbsp;while i &gt; 0 do <br>&nbsp; begin<br> &nbsp; &nbsp;Path[j] := i;<br> &nbsp; &nbsp;i := Prev[i];<br> &nbsp; &nbsp;inc(j);<br> &nbsp;end;<br> &nbsp;Path[j] := 0;<br> &nbsp;for i := j downto 1 do<br> &nbsp; &nbsp;write(Path[i], ' ');&nbsp;&nbsp;</p>
</div>
</div>
</div>
<p>&nbsp;В конце в список Path добавляется начальная вершина номер 0, которая не была обработана в основном цикле, а затем весь список Path разворачивается в обратном порядке (т. к. вершины добавляются в обратном порядке, от конечной к начальной).</p>
<p>Но можно обойтись и без списка Prev. Мы в любой момент можем определить, из какой точки кузнечик пришел в точку i, если сравним C[i-1] и C[i-2]. Поэтому решение о том, к какой вершине переходить при восстановлении ответа можно принимать непосредственно при восстановлении ответа, сравнив C[i-1] и C[i-2]. Путь восстанавливается через ту вершину, для которой значение C будет меньше.</p>
<div class="toggle_element">
<h3 class="toggle_header">ПРимер программы на языке Python</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>Path = []<br>i = n<br>while i &gt; 0:<br> &nbsp; &nbsp;if C[i — 1] &lt; C[i — 2]:<br> &nbsp; &nbsp; &nbsp; &nbsp;prev = i — 1<br> &nbsp; &nbsp;else:<br> &nbsp; &nbsp; &nbsp; &nbsp;prev = i - 2<br> &nbsp; &nbsp;Path.append(prev)<br> &nbsp; &nbsp;i = prev<br>Path.append(0)<br>Path = Path[::-1]</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div>
<div class="toggle_element">
<h3 class="toggle_header">Пример программы на языке Pascal:</h3>
<div class="toggle_content">
<div class="page_code_style">
<p>var<br> &nbsp;C, Price, Path: array[-1..100] of longint;<br> &nbsp;j, i, n, prev: longint;<br>begin<br> &nbsp;readln(n);<br> &nbsp;for i := 1 to n do<br> &nbsp; &nbsp;read(Price[i]);<br> &nbsp;for i := 1 to n do<br> &nbsp; &nbsp;C[i] := 0;<br> &nbsp;C[-1] := -1; &nbsp;<br> &nbsp;C[0] := 0;<br> &nbsp;C[1] := Price[1];<br> &nbsp;for i := 2 to n do<br> &nbsp; &nbsp;C[i] := min(C[i - 1], C[i - 2]) + Price[i];<br> &nbsp;i := n;<br> &nbsp;j := 1;<br> &nbsp;Path[j] := i;<br> &nbsp;while i &gt; 0 do <br>&nbsp; begin<br> &nbsp; &nbsp;inc(j);<br> &nbsp; &nbsp;if C[i - 1] &lt; C[i - 2] then<br> &nbsp; &nbsp; &nbsp;prev := i - 1<br> &nbsp; &nbsp;else<br> &nbsp; &nbsp; &nbsp;prev := i - 2;<br> &nbsp; &nbsp;Path[j] := prev;<br> &nbsp; &nbsp;i := prev;<br> &nbsp;end;<br> &nbsp;Path[j] := 0;<br> &nbsp;for i := j downto 1 do<br> &nbsp; &nbsp;write(Path[i], ' '); <br>end.</p>
</div>
</div>
<div class="toggle_line">
<div class="toggle_arrow">&nbsp;</div>
</div>
</div></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>