<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>22. Статическая задача RMQ</title></head><body><h1>22. Статическая задача RMQ</h1>
<div class="page_content_main"><h1>Статическая задача RMQ</h1>
<p>Рассмотрим статическую задачу RMQ (range max query) - дан числовой массив и запросы нахождения наибольшего значения на отрезке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.088ex" height="2.776ex" viewBox="0 -817.1 1760.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-5B" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="278" y="0"></use><use xlink:href="#MJMAIN-2C" x="624" y="0"></use><use xlink:href="#MJMATHI-6A" x="1069" y="0"></use><use xlink:href="#MJMAIN-5D" x="1481" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">[i, j]</script>.</p>
<p>Можно решить статическую задачу RMQ используя метод корневой декомпозиции. Пусть <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2308;</mo><msqrt><mi>N</mi></msqrt><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2309;</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.374ex" height="3.213ex" viewBox="0 -1005.2 4466.6 1383.4" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="799" y="0"></use><use xlink:href="#MJMAIN-2308" x="1855" y="0"></use><g transform="translate(2300,0)"><use xlink:href="#MJMAIN-221A" x="0" y="54"></use><rect stroke="none" width="888" height="60" x="833" y="795"></rect><use xlink:href="#MJMATHI-4E" x="833" y="0"></use></g><use xlink:href="#MJMAIN-2309" x="4022" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mo fence="false" stretchy="false">⌈</mo><msqrt><mi>N</mi></msqrt><mo fence="false" stretchy="false">⌉</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">k=\lceil\sqrt{N}\rceil</script> (целая часть <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msqrt><mi>N</mi></msqrt></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.999ex" height="2.922ex" viewBox="0 -1005.2 1722 1258" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-221A" x="0" y="54"></use><rect stroke="none" width="888" height="60" x="833" y="795"></rect><use xlink:href="#MJMATHI-4E" x="833" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mi>N</mi></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-46">\sqrt{N}</script>, округленная вверх). Разобьем массив из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.048ex" viewBox="0 -754.4 888.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">N</script> элементов на <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">k</script> отрезков длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">k</script> (последний отрезок может быть короче <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">k</script>). Для каждого из отрезков посчитаем наибольшее значение на этом подотрезке. Назовем эти отрезки "крупными".</p>
<p>При получении запроса на сумму элементов, этот запрос покрывает какое-то число "крупных" отрезков, а также конец одного "крупного" отрезка и начало другого. Возможен и частный случай - например, когда запрос целиком попадает внутрь крупного отрезка, тогда он покрывает часть одного "крупного" отрезка, но ни один "крупный" отрезок не покрывает целиком.</p>
<p>В любом случае для решения задачи нужно разбить искомый отрезок на несколько "крупных" и не более двух частей, находящихся внутри "крупных". В качестве ответа нужно взять максимальное значение из максимума на всех частях. При этом ответ для каждого "крупного" отрезка уже подсчитан, а каждая из частей "крупного" отрезка обрабатывается проходом по всей части. Количество "крупных" отрезков не превосходит <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">k</script>, количество элементов в каждой части, не совпадающей с "крупным" отрезком также не превосходит <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">k</script>, поэтому обработка одного запроса будет иметь сложность <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msqrt><mi>N</mi></msqrt><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.474ex" height="3.213ex" viewBox="0 -1005.2 6662.6 1383.4" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMATHI-6B" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1674" y="0"></use><use xlink:href="#MJMAIN-3D" x="2341" y="0"></use><use xlink:href="#MJMATHI-4F" x="3398" y="0"></use><use xlink:href="#MJMAIN-28" x="4161" y="0"></use><g transform="translate(4551,0)"><use xlink:href="#MJMAIN-221A" x="0" y="54"></use><rect stroke="none" width="888" height="60" x="833" y="795"></rect><use xlink:href="#MJMATHI-4E" x="833" y="0"></use></g><use xlink:href="#MJMAIN-29" x="6273" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>N</mi></msqrt><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">O(k) = O(\sqrt{N})</script>.</p>
<p>Можно реализовать идею корневой декомпозиции для запросов, изменяющих значение отдельных элементов (при условии, что значение каждого элемента может только увеличиваться) аналогично решению задачи RSQ.</p><h1>Sparse table</h1>
<p>Идею разбиения на отрезки для задачи RMQ можно улучшить, если заметить, что отрезки в разбиении могут пересекаться. То есть если <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.194ex" viewBox="0 -817.1 750.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">A</script> - отрезок и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mi>B</mi><mo>&amp;#x222A;</mo><mi>C</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.954ex" height="2.194ex" viewBox="0 -817.1 4716.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-41" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="1028" y="0"></use><use xlink:href="#MJMATHI-42" x="2084" y="0"></use><use xlink:href="#MJMAIN-222A" x="3066" y="0"></use><use xlink:href="#MJMATHI-43" x="3956" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo><mi>B</mi><mo>∪</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">A=B\cup C</script>, где <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.048ex" viewBox="0 -754.4 759.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-42" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">B</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.194ex" viewBox="0 -817.1 760.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">C</script> - меньшие отрезки, тогда <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mi>C</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.946ex" height="2.776ex" viewBox="0 -817.1 14615.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use><use xlink:href="#MJMAIN-28" x="1862" y="0"></use><use xlink:href="#MJMATHI-41" x="2252" y="0"></use><use xlink:href="#MJMAIN-29" x="3002" y="0"></use><use xlink:href="#MJMAIN-3D" x="3669" y="0"></use><g transform="translate(4726,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="6588" y="0"></use><g transform="translate(6978,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="8840" y="0"></use><use xlink:href="#MJMATHI-42" x="9230" y="0"></use><use xlink:href="#MJMAIN-29" x="9989" y="0"></use><use xlink:href="#MJMAIN-2C" x="10379" y="0"></use><g transform="translate(10824,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="12686" y="0"></use><use xlink:href="#MJMATHI-43" x="13076" y="0"></use><use xlink:href="#MJMAIN-29" x="13836" y="0"></use><use xlink:href="#MJMAIN-29" x="14226" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>,</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">\max(A)=\max(\max(B), \max(C))</script>.</p>
<p>В алгоритме RMQ с использованием Sparse table рассматриваются отрезки, длины которых равны степеням двойки: 1, 2, 4, … А именно, cначала нужно посчитать сумму на всех подотрезках данного массива, длины которых являются степенями двойки. Пусть:</p>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><msup><mn>2</mn><mi>j</mi></msup><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.408ex" height="2.922ex" viewBox="0 -817.1 14383.9 1258" role="img" focusable="false" style="vertical-align: -1.024ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1580" y="0"></use><g transform="translate(2636,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="4498" y="0"></use><g transform="translate(4888,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2C" x="5762" y="0"></use><g transform="translate(6207,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2B" x="7303" y="0"></use><use xlink:href="#MJMAIN-31" x="8304" y="0"></use><use xlink:href="#MJMAIN-2C" x="8804" y="0"></use><use xlink:href="#MJMAIN-2026" x="9249" y="0"></use><use xlink:href="#MJMAIN-2C" x="10589" y="0"></use><g transform="translate(11034,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-266)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="345" y="0"></use><g transform="translate(794,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.502)" xlink:href="#MJMATHI-6A" x="705" y="554"></use></g><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="2017" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="2795" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="13994" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><msup><mn>2</mn><mi>j</mi></msup><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">s_{i, j} = \max(a_i, a_i+1, …, a_{i+2^j - 1})</script></p></div>
<p>то есть <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.025ex" height="2.194ex" viewBox="0 -566.3 1302.4 944.5" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">s_{i, j}</script> есть максимум на подотрезке, первым элементом которого является <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.029ex" height="1.902ex" viewBox="0 -566.3 873.8 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="748" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">a_i</script>, а длина которого равна <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mi>j</mi></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.072ex" height="2.485ex" viewBox="0 -942.5 892.2 1069.9" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="707" y="557"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>j</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-62">2^j</script>. Таких отрезков не более, чем <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2308;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2309;</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.551ex" height="2.776ex" viewBox="0 -817.1 4112.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4E" x="0" y="0"></use><use xlink:href="#MJMAIN-2308" x="888" y="0"></use><g transform="translate(1333,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="#MJMATHI-4E" x="2779" y="0"></use><use xlink:href="#MJMAIN-2309" x="3667" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo fence="false" stretchy="false">⌈</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo fence="false" stretchy="false">⌉</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">N\lceil \log N\rceil</script>.</p>
<p>Для хранения значений <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.025ex" height="2.194ex" viewBox="0 -566.3 1302.4 944.5" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">s_{i, j}</script> заведём двумерный массив размера <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>L</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.299ex" height="2.776ex" viewBox="0 -817.1 5295.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4E" x="0" y="0"></use><use xlink:href="#MJMAIN-D7" x="1110" y="0"></use><use xlink:href="#MJMAIN-28" x="2111" y="0"></use><use xlink:href="#MJMATHI-4C" x="2500" y="0"></use><use xlink:href="#MJMAIN-2B" x="3404" y="0"></use><use xlink:href="#MJMAIN-31" x="4405" y="0"></use><use xlink:href="#MJMAIN-29" x="4905" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>×</mo><mo stretchy="false">(</mo><mi>L</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">N\times (L + 1)</script>, где <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230A;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230B;</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.169ex" height="2.776ex" viewBox="0 -817.1 5239.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4C" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="959" y="0"></use><use xlink:href="#MJMAIN-230A" x="2015" y="0"></use><g transform="translate(2460,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="#MJMATHI-4E" x="3906" y="0"></use><use xlink:href="#MJMAIN-230B" x="4794" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mo fence="false" stretchy="false">⌊</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo fence="false" stretchy="false">⌋</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">L= \lfloor \log N\rfloor</script>. Элементы массива заполняются по формулам:</p>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.297ex" height="2.194ex" viewBox="0 -566.3 3572.5 944.5" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="624" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1642" y="0"></use><g transform="translate(2698,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="748" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">s_{i, 0} = a_i</script></p></div>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.779ex" height="3.068ex" viewBox="0 -817.1 11960.3 1320.7" role="img" focusable="false" style="vertical-align: -1.17ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use></g><use xlink:href="#MJMAIN-3D" x="1580" y="0"></use><g transform="translate(2636,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use></g><use xlink:href="#MJMAIN-28" x="4498" y="0"></use><g transform="translate(4888,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="1036" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1815" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="7095" y="0"></use><g transform="translate(7540,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-269)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="345" y="0"></use><g transform="translate(794,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="0" y="0"></use><g transform="translate(353,277)"><use transform="scale(0.502)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.502)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.502)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="2924" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="3202" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="3615" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="4393" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="11570" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">s_{i, j} = \max(s_{i, j - 1}, s_{i+2^{j - 1}, j - 1})</script></p></div>
<p>Каждый отрезок длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mi>j</mi></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.072ex" height="2.485ex" viewBox="0 -942.5 892.2 1069.9" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="707" y="557"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>j</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-69">2^j</script> разбивается на два отрезка длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.173ex" height="2.485ex" viewBox="0 -942.5 1796.6 1069.9" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-70">2^{j-1}</script>. Таким образом, для хранения этого массива нужно <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.456ex" height="2.776ex" viewBox="0 -817.1 4932.3 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMATHI-4E" x="1153" y="0"></use><g transform="translate(2208,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="#MJMATHI-4E" x="3654" y="0"></use><use xlink:href="#MJMAIN-29" x="4542" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">O(N\log N)</script> памяти и также <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.456ex" height="2.776ex" viewBox="0 -817.1 4932.3 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMATHI-4E" x="1153" y="0"></use><g transform="translate(2208,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="#MJMATHI-4E" x="3654" y="0"></use><use xlink:href="#MJMAIN-29" x="4542" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">O(N\log N)</script> времени для заполнения.</p>
<p>После этого для вычисления максимума на отрезке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.088ex" height="2.776ex" viewBox="0 -817.1 1760.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-5B" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="278" y="0"></use><use xlink:href="#MJMAIN-2C" x="624" y="0"></use><use xlink:href="#MJMATHI-6A" x="1069" y="0"></use><use xlink:href="#MJMAIN-5D" x="1481" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">[i, j]</script> нужно выполнить следующее:</p>
<p>1. Найти значение <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230A;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo>&amp;#x2212;</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x230B;</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.146ex" height="2.776ex" viewBox="0 -817.1 8674.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="799" y="0"></use><use xlink:href="#MJMAIN-230A" x="1855" y="0"></use><g transform="translate(2300,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(3746,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-6A" x="389" y="0"></use><use xlink:href="#MJMAIN-2212" x="1024" y="0"></use><use xlink:href="#MJMATHI-69" x="2024" y="0"></use><use xlink:href="#MJMAIN-2B" x="2592" y="0"></use><use xlink:href="#MJMAIN-31" x="3593" y="0"></use><use xlink:href="#MJMAIN-29" x="4093" y="0"></use></g><use xlink:href="#MJMAIN-230B" x="8229" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mo fence="false" stretchy="false">⌊</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo fence="false" stretchy="false">⌋</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">k=\lfloor\log {(j - i + 1)}\rfloor</script>.</p>
<p>2. Отрезок <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.088ex" height="2.776ex" viewBox="0 -817.1 1760.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-5B" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="278" y="0"></use><use xlink:href="#MJMAIN-2C" x="624" y="0"></use><use xlink:href="#MJMATHI-6A" x="1069" y="0"></use><use xlink:href="#MJMAIN-5D" x="1481" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">[i, j]</script> разбивается на два отрезка длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.194ex" viewBox="0 -817.1 521.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">k</script> - с началом в <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.029ex" height="1.902ex" viewBox="0 -566.3 873.8 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="748" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-77">a_i</script> и с началом в <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.112ex" height="2.485ex" viewBox="0 -566.3 3062.3 1069.9" role="img" focusable="false" style="vertical-align: -1.17ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-283)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><g transform="translate(842,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.502)" xlink:href="#MJMATHI-6B" x="705" y="554"></use></g><use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="2161" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="2939" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-78">a_{j - 2^k + 1}</script>.</p>
<p>3. Ответом будет <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.66ex" height="3.068ex" viewBox="0 -817.1 8034.1 1320.7" role="img" focusable="false" style="vertical-align: -1.17ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-61" x="833" y="0"></use><use xlink:href="#MJMAIN-78" x="1334" y="0"></use><use xlink:href="#MJMAIN-28" x="1862" y="0"></use><g transform="translate(2252,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6B" x="624" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="3631" y="0"></use><g transform="translate(4076,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-283)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><g transform="translate(842,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.502)" xlink:href="#MJMATHI-6B" x="705" y="554"></use></g><use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="2161" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="2939" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="3440" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6B" x="3718" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="7644" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">\max(s_{i, k}, s_{j - 2^k + 1, k})</script>.</p>
<p>Таким образом, задача RMQ будет решаться при помощи предподсчета сложности <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mi>N</mi><mi>log</mi><mo>&amp;#x2061;</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.551ex" height="2.776ex" viewBox="0 -817.1 4542.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMATHI-4E" x="763" y="0"></use><g transform="translate(1818,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="#MJMATHI-4E" x="3264" y="0"></use><use xlink:href="#MJMAIN-29" x="4153" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">ON\log N)</script> и с обработкой одного запроса за <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.776ex" viewBox="0 -817.1 2043 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMAIN-31" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-81">O(1)</script>.</p>
<p>Мы не учитывали в оценке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.776ex" viewBox="0 -817.1 2043 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMAIN-31" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">O(1)</script> сложность вычисления логарифма длины отрезка. Для того, чтобы вычислять логарифм за <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.776ex" viewBox="0 -817.1 2043 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMAIN-31" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">O(1)</script> нужно предподсчитать заранее логарифмы всех чисел от 1 до <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.048ex" viewBox="0 -754.4 888.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">N</script> и сохранить их в массиве.</p>
<p>Sparse table не позволяет обрабатывать запросы, модифицирующие значения массива.</p></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>