<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>15. Полиномиальное хеширование строк</title></head><body><h1>15. Полиномиальное хеширование строк</h1>
<div class="page_content_main"><p>Основная идея хеширования (использования хеш-функций) следующая. Каждому объекту сопоставим некоторое число, которое называется <em>хешем</em>. Сама функция, которая для данного объекта вычисляет это число, называется <em>хеш-функцией</em>.</p>
<p>Хеш-функция должна обладать следующими свойствами:</p>
<ol>
<li>Она должна относительно легко вычисляться для объекта.</li>
<li>Значения функции должны быть "похожи" на случайные, т.е. значения хеш-функции должны быть мало предсказуемы.</li>
<li>Значения хеш-функции должны быть равномерно (или близко к равномерному) распределены, не должно быть значений хеш-функции, которое встречается существенно чаще других значений.</li>
<li>Необходимо тем самым минимизировать вероятность коллизии, то есть совпадения значений хеш-функции для двух различных объектов, для достижения этого как раз и требуется близость распределения значения хеш-функции к равномерному.</li>
</ol>
<p>Хеширование часто применяется для решения задач на строки.</p>
<p>Для начала рассмотрим алгоритм вычисления хеш-функции для строк.</p>
<p>Определим значение хеш-функции для строк длины 1. Каждому возможному символу строки сопопоставим уникальное целое положительное число~-— значение хеш-функции от этого символа. Например, можно взять ASCII-код или Unicode символа или если строка состоит только из строчных латинских букв, можно взять <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.008ex" height="2.922ex" viewBox="0 -879.8 4309.2 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(1260,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="748" y="513"></use></g><use xlink:href="#MJMAIN-29" x="2085" y="0"></use><use xlink:href="#MJMAIN-3D" x="2752" y="0"></use><use xlink:href="#MJMAIN-31" x="3808" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>a</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">h('a')=1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>b</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.776ex" height="2.922ex" viewBox="0 -879.8 4209.2 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(1260,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="607" y="513"></use></g><use xlink:href="#MJMAIN-29" x="1985" y="0"></use><use xlink:href="#MJMAIN-3D" x="2652" y="0"></use><use xlink:href="#MJMAIN-32" x="3708" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>b</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">h('b')=2</script>, …, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>z</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>26</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.031ex" height="2.922ex" viewBox="0 -879.8 4749.6 1258" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(1260,0)"><use xlink:href="#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="663" y="513"></use></g><use xlink:href="#MJMAIN-29" x="2025" y="0"></use><use xlink:href="#MJMAIN-3D" x="2692" y="0"></use><g transform="translate(3748,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-36" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>z</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mn>26</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">h('z') = 26</script>. Пустой строке будет соответствовать нулевое значение хеш-функции, поэтому не следует использовать число 0 для значения хеш-функции от какого-либо одного символа.</p>
<p><br>Для строк длины 2 желательно выбрать такой алгоритм вычисления хеш-функции, который<br>обладал бы следующими свойствами:<br><br></p>
<ol>
<li>Значение хеш-функции для всех строк длины 1 и 2 были бы различными.</li>
<li>Использовались бы значения хеш-функции для одного символа, определенные ранее.</li>
<li>Алгоритм легко обобщается на строки большей длины.</li>
</ol>
<p><br><br>Простое решение — для строки из двух символов <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.568ex" height="1.902ex" viewBox="0 -566.3 1966.8 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><g transform="translate(983,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">a_0a_1</script> значение хеш-функции вычислить по формуле <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.517ex" height="2.776ex" viewBox="0 -817.1 10986.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><g transform="translate(966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(1949,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="2932" y="0"></use><use xlink:href="#MJMAIN-3D" x="3600" y="0"></use><use xlink:href="#MJMATHI-68" x="4656" y="0"></use><use xlink:href="#MJMAIN-28" x="5232" y="0"></use><g transform="translate(5622,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="6605" y="0"></use><use xlink:href="#MJMATHI-62" x="6995" y="0"></use><use xlink:href="#MJMAIN-2B" x="7646" y="0"></use><use xlink:href="#MJMATHI-68" x="8647" y="0"></use><use xlink:href="#MJMAIN-28" x="9224" y="0"></use><g transform="translate(9613,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="10597" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">h(a_0a_1) = h(a_0)b + h(a_1)</script>. Если при этом выбрать значение <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">b</script> большим, чем максимальное возможное значение хеш-функции от одного символа (например, если используются только латинские буквы, то можно взять <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mo>=</mo><mn>27</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.421ex" height="2.194ex" viewBox="0 -817.1 2764.6 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="707" y="0"></use><g transform="translate(1763,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-37" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mn>27</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">b=27</script>), то тогда у всех строк длины 2 значения хеш-функции будут различными.<br><br>Для строк длины 3 можно определить значение хеш-функции следующим образом: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mn>2</mn></msup><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.126ex" height="3.068ex" viewBox="0 -942.5 16415.3 1320.7" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><g transform="translate(966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(1949,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(2932,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="3916" y="0"></use><use xlink:href="#MJMAIN-3D" x="4583" y="0"></use><use xlink:href="#MJMATHI-68" x="5639" y="0"></use><use xlink:href="#MJMAIN-28" x="6216" y="0"></use><g transform="translate(6605,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="7589" y="0"></use><g transform="translate(7978,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="607" y="513"></use></g><use xlink:href="#MJMAIN-2B" x="9084" y="0"></use><use xlink:href="#MJMATHI-68" x="10085" y="0"></use><use xlink:href="#MJMAIN-28" x="10661" y="0"></use><g transform="translate(11051,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="12034" y="0"></use><use xlink:href="#MJMATHI-62" x="12423" y="0"></use><use xlink:href="#MJMAIN-2B" x="13075" y="0"></use><use xlink:href="#MJMATHI-68" x="14076" y="0"></use><use xlink:href="#MJMAIN-28" x="14652" y="0"></use><g transform="translate(15042,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="16025" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mn>2</mn></msup><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">h(a_0a_1a_2)=h(a_0)b^2 + h(a_1)b+h(a_2)</script> и т.д. Например, если взять <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mo>=</mo><mn>27</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.421ex" height="2.194ex" viewBox="0 -817.1 2764.6 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="707" y="0"></use><g transform="translate(1763,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-37" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mn>27</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">b=27</script>, то хеш-функция от строки 'one' будет равна <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><mi>o</mi><mi>n</mi><msup><mi>e</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>o</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mn>2</mn></msup><mo>+</mo><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>n</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><msup><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2032;</mo></msup><msup><mi>e</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>15</mn><mo>&amp;#x22C5;</mo><msup><mn>27</mn><mn>2</mn></msup><mo>+</mo><mn>14</mn><mo>&amp;#x22C5;</mo><mn>27</mn><mo>+</mo><mn>5</mn><mo>=</mo><mn>11318</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.676ex" height="3.068ex" viewBox="0 -942.5 29999.1 1320.7" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><g transform="translate(576,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><use xlink:href="#MJMATHI-6F" x="1260" y="0"></use><use xlink:href="#MJMATHI-6E" x="1746" y="0"></use><g transform="translate(2346,0)"><use xlink:href="#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="659" y="513"></use></g><use xlink:href="#MJMAIN-29" x="3108" y="0"></use><use xlink:href="#MJMAIN-3D" x="3775" y="0"></use><use xlink:href="#MJMATHI-68" x="4831" y="0"></use><g transform="translate(5408,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(6092,0)"><use xlink:href="#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="686" y="513"></use></g><use xlink:href="#MJMAIN-29" x="6872" y="0"></use><g transform="translate(7262,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="607" y="513"></use></g><use xlink:href="#MJMAIN-2B" x="8367" y="0"></use><use xlink:href="#MJMATHI-68" x="9368" y="0"></use><g transform="translate(9945,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(10629,0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="849" y="513"></use></g><use xlink:href="#MJMAIN-29" x="11524" y="0"></use><use xlink:href="#MJMATHI-62" x="11914" y="0"></use><use xlink:href="#MJMAIN-2B" x="12565" y="0"></use><use xlink:href="#MJMATHI-68" x="13566" y="0"></use><g transform="translate(14143,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="550" y="513"></use></g><g transform="translate(14827,0)"><use xlink:href="#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="659" y="513"></use></g><use xlink:href="#MJMAIN-29" x="15588" y="0"></use><use xlink:href="#MJMAIN-3D" x="16256" y="0"></use><g transform="translate(17312,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="#MJMAIN-22C5" x="18535" y="0"></use><g transform="translate(19036,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-37" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1415" y="571"></use></g><use xlink:href="#MJMAIN-2B" x="20713" y="0"></use><g transform="translate(21714,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="#MJMAIN-22C5" x="22937" y="0"></use><g transform="translate(23438,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-37" x="500" y="0"></use></g><use xlink:href="#MJMAIN-2B" x="24661" y="0"></use><use xlink:href="#MJMAIN-35" x="25662" y="0"></use><use xlink:href="#MJMAIN-3D" x="26440" y="0"></use><g transform="translate(27496,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-31" x="500" y="0"></use><use xlink:href="#MJMAIN-33" x="1001" y="0"></use><use xlink:href="#MJMAIN-31" x="1501" y="0"></use><use xlink:href="#MJMAIN-38" x="2002" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><mi>o</mi><mi>n</mi><msup><mi>e</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>o</mi><mo>′</mo></msup><mo stretchy="false">)</mo><msup><mi>b</mi><mn>2</mn></msup><mo>+</mo><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>n</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><msup><mo stretchy="false">(</mo><mo>′</mo></msup><msup><mi>e</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mn>15</mn><mo>⋅</mo><msup><mn>27</mn><mn>2</mn></msup><mo>+</mo><mn>14</mn><mo>⋅</mo><mn>27</mn><mo>+</mo><mn>5</mn><mo>=</mo><mn>11318</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">h('one')= h('o')b^2+h('n')b+h('e') = 15\cdot27^2+14\cdot27+5=11318</script>.<br><br>Соответственно, для строки длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">n</script> значение хеш-функции можно определить так: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>&amp;#x2026;</mo><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="71.119ex" height="3.068ex" viewBox="0 -942.5 30620.7 1320.7" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><g transform="translate(966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(1949,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(2932,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="4082" y="0"></use><g transform="translate(5422,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="7380" y="0"></use><use xlink:href="#MJMAIN-3D" x="8047" y="0"></use><use xlink:href="#MJMATHI-68" x="9104" y="0"></use><use xlink:href="#MJMAIN-28" x="9680" y="0"></use><g transform="translate(10070,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11053" y="0"></use><g transform="translate(11443,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="13523" y="0"></use><use xlink:href="#MJMATHI-68" x="14524" y="0"></use><use xlink:href="#MJMAIN-28" x="15100" y="0"></use><g transform="translate(15490,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="16473" y="0"></use><g transform="translate(16863,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="18944" y="0"></use><use xlink:href="#MJMAIN-2026" x="19944" y="0"></use><use xlink:href="#MJMAIN-2B" x="21339" y="0"></use><use xlink:href="#MJMATHI-68" x="22340" y="0"></use><use xlink:href="#MJMAIN-28" x="22916" y="0"></use><g transform="translate(23306,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="25264" y="0"></use><use xlink:href="#MJMATHI-62" x="25654" y="0"></use><use xlink:href="#MJMAIN-2B" x="26306" y="0"></use><use xlink:href="#MJMATHI-68" x="27306" y="0"></use><use xlink:href="#MJMAIN-28" x="27883" y="0"></use><g transform="translate(28272,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="30231" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">h(a_0a_1a_2\ldots a_{n-1})=h(a_0)b^{n-1} + h(a_1)b^{n-2}+…+h(a_{n-2})b+h(a_{n-1})</script>. Это значение также равно значению числа <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mover><mrow><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></mrow><mo accent=&quot;false&quot;>&amp;#x00AF;</mo></mover></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.013ex" height="2.776ex" viewBox="0 -879.8 6464.1 1195.3" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(24,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><g transform="translate(983,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(1966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3116" y="0"></use><g transform="translate(4456,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g><g transform="translate(0,258)"><use transform="scale(0.707)" xlink:href="#MJMAIN-AF" x="-70" y="0"></use><g transform="translate(-881.3829378180586,0) scale(23.128974162684038,1)"><use transform="scale(0.707)" xlink:href="#MJMAIN-AF"></use></g><use transform="scale(0.707)" xlink:href="#MJMAIN-AF" x="8641" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo accent="false">¯</mo></mover></math></span></span><script type="math/tex" id="MathJax-Element-13">\overline{a_0a_1a_2\ldots a_{n-1}}</script> в системе счисления с основанием <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">b</script>, то есть числом, записанного символами <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.898ex" height="2.048ex" viewBox="0 -566.3 6414.6 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><g transform="translate(983,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(1966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3116" y="0"></use><g transform="translate(4456,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">a_0a_1a_2\ldots a_{n-1}</script>,&nbsp; если считать, что один символ соответствует одной цифре в системе счисления с основанием <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">b</script>, а значением цифры является значение хеш-функции от этого символа. Также можно рассмотреть это, как значение многочлена степени <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.194ex" viewBox="0 -754.4 2323.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="822" y="0"></use><use xlink:href="#MJMAIN-31" x="1823" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">n - 1</script> с коэффициентами <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.284ex" height="1.902ex" viewBox="0 -566.3 983.4 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">a_0</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.284ex" height="1.902ex" viewBox="0 -566.3 983.4 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-19">a_1</script>, …, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.549ex" height="2.048ex" viewBox="0 -566.3 1958.5 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">a_{n-1}</script>, вычисленное при <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.426ex" height="2.194ex" viewBox="0 -817.1 2336.1 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-78" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="850" y="0"></use><use xlink:href="#MJMATHI-62" x="1906" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">x=b</script>.<br><br>Но при длинной строке результатом вычисления по этой формуле будет очень большое число (длина которого будет порядка длины строки), поэтому использовать такой хеш для решения задач нельзя (так как основным смыслом хеш-функции явлется сопоставление большому объекту некоторого относительно небольшого числа), поэтому в качестве значения хеш-функции возьмем остаток от деления полученного числа на некоторое большое число <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">M</script>. В качестве значения <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">M</script> рекомендуется выбирать большое простое число, также часто в качестве значения <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">M</script> выбирают степень числа 2, равную размеру целочисленного типа данных, например, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>32</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.485ex" viewBox="0 -942.5 1308.3 1069.9" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-25">2^{32}</script> или <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>64</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.485ex" viewBox="0 -942.5 1308.3 1069.9" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>64</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-26">2^{64}</script>. Обязательное требование к числу <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">M</script>~-— оно должно быть взаимно простым с числом <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">b</script>. Итак, определим значение хеш-функции от строки:<br><br></p><div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>&amp;#x2026;</mo><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="81.052ex" height="3.068ex" viewBox="0 -942.5 34897.3 1320.7" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><g transform="translate(966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(1949,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(2932,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="4082" y="0"></use><g transform="translate(5422,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="7380" y="0"></use><use xlink:href="#MJMAIN-3D" x="8047" y="0"></use><use xlink:href="#MJMAIN-28" x="9104" y="0"></use><use xlink:href="#MJMATHI-68" x="9493" y="0"></use><use xlink:href="#MJMAIN-28" x="10070" y="0"></use><g transform="translate(10459,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="11443" y="0"></use><g transform="translate(11832,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="13913" y="0"></use><use xlink:href="#MJMATHI-68" x="14913" y="0"></use><use xlink:href="#MJMAIN-28" x="15490" y="0"></use><g transform="translate(15879,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="16863" y="0"></use><g transform="translate(17252,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="19333" y="0"></use><use xlink:href="#MJMAIN-2026" x="20334" y="0"></use><use xlink:href="#MJMAIN-2B" x="21729" y="0"></use><use xlink:href="#MJMATHI-68" x="22729" y="0"></use><use xlink:href="#MJMAIN-28" x="23306" y="0"></use><g transform="translate(23695,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="25654" y="0"></use><use xlink:href="#MJMATHI-62" x="26043" y="0"></use><use xlink:href="#MJMAIN-2B" x="26695" y="0"></use><use xlink:href="#MJMATHI-68" x="27696" y="0"></use><use xlink:href="#MJMAIN-28" x="28272" y="0"></use><g transform="translate(28662,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="30620" y="0"></use><use xlink:href="#MJMAIN-29" x="31010" y="0"></use><g transform="translate(31677,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="33845" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">h(a_0a_1a_2\ldots a_{n-1})=(h(a_0)b^{n-1} + h(a_1)b^{n-2}+…+h(a_{n-2})b+h(a_{n-1})) \bmod M</script></p></div><p><br><br>Значение определенной таким образом хеш-функции удобно вычислять, как и значение многочлена по схеме Горнера пользуясь свойством:<br><br></p><div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.5ex" height="2.776ex" viewBox="0 -817.1 8826.3 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><g transform="translate(966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(1949,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(2932,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="4082" y="0"></use><g transform="translate(5422,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="7380" y="0"></use><use xlink:href="#MJMAIN-3D" x="8047" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-30"> h(a_0a_1a_2\ldots a_{n-1})= </script></p></div>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mrow><mo>(</mo><mrow><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>3</mn></mrow></msup><mo>+</mo><mo>&amp;#x2026;</mo><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi><mo>=</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.943ex" height="3.213ex" viewBox="0 -942.5 28822.7 1383.4" role="img" focusable="false" style="vertical-align: -1.024ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-3D" x="0" y="0"></use><g transform="translate(1056,0)"><use xlink:href="#MJSZ1-28"></use><g transform="translate(458,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-68" x="389" y="0"></use><use xlink:href="#MJMAIN-28" x="966" y="0"></use><g transform="translate(1355,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="2338" y="0"></use><g transform="translate(2728,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="4809" y="0"></use><use xlink:href="#MJMATHI-68" x="5809" y="0"></use><use xlink:href="#MJMAIN-28" x="6386" y="0"></use><g transform="translate(6775,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-29" x="7759" y="0"></use><g transform="translate(8148,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-2B" x="10229" y="0"></use><use xlink:href="#MJMAIN-2026" x="11230" y="0"></use><use xlink:href="#MJMAIN-2B" x="12624" y="0"></use><use xlink:href="#MJMATHI-68" x="13625" y="0"></use><use xlink:href="#MJMAIN-28" x="14202" y="0"></use><g transform="translate(14591,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="16550" y="0"></use><use xlink:href="#MJMAIN-29" x="16939" y="0"></use><use xlink:href="#MJMATHI-62" x="17329" y="0"></use><use xlink:href="#MJMAIN-2B" x="17980" y="0"></use><use xlink:href="#MJMATHI-68" x="18981" y="0"></use><use xlink:href="#MJMAIN-28" x="19558" y="0"></use><g transform="translate(19947,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="21906" y="0"></use></g><use xlink:href="#MJSZ1-29" x="22754" y="-1"></use></g><g transform="translate(24546,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="26714" y="0"></use><use xlink:href="#MJMAIN-3D" x="28044" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mrow><mo>(</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>3</mn></mrow></msup><mo>+</mo><mo>…</mo><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-31"> =\left((h(a_0)b^{n-2} + h(a_1)b^{n-3}+…+h(a_{n-2}))b+h(a_{n-1})\right) \bmod M = </script></p></div>
<div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.968ex" height="2.776ex" viewBox="0 -817.1 18069.3 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-3D" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="1056" y="0"></use><use xlink:href="#MJMATHI-68" x="1445" y="0"></use><use xlink:href="#MJMAIN-28" x="2022" y="0"></use><g transform="translate(2411,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use></g><g transform="translate(3395,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(4378,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="5528" y="0"></use><g transform="translate(6867,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="8826" y="0"></use><use xlink:href="#MJMATHI-62" x="9215" y="0"></use><use xlink:href="#MJMAIN-2B" x="9867" y="0"></use><use xlink:href="#MJMATHI-68" x="10868" y="0"></use><use xlink:href="#MJMAIN-28" x="11444" y="0"></use><g transform="translate(11834,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="13792" y="0"></use><use xlink:href="#MJMAIN-29" x="14182" y="0"></use><g transform="translate(14849,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="17017" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo stretchy="false">)</mo><mi>b</mi><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-32"> =(h(a_0a_1a_2\ldots a_{n-2})b + h(a_{n-1}))\bmod M </script></p></div><p><br><br>То есть чтобы вычислить хеш-функцию от строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.898ex" height="2.048ex" viewBox="0 -566.3 6414.6 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><g transform="translate(983,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(1966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3116" y="0"></use><g transform="translate(4456,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">a_0a_1a_2\ldots a_{n-1}</script> необходимо взять<br>вычислить хеш-функцию от строки без одного последнего символа <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.898ex" height="2.048ex" viewBox="0 -566.3 6414.6 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="748" y="-213"></use><g transform="translate(983,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="748" y="-213"></use></g><g transform="translate(1966,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="3116" y="0"></use><g transform="translate(4456,0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1379" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>…</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">a_0a_1a_2\ldots a_{n-2}</script>,<br>умножить результат на <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">b</script>, добавить значение последнего символа <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.549ex" height="2.048ex" viewBox="0 -566.3 1958.5 881.8" role="img" focusable="false" style="vertical-align: -0.733ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1379" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">a_{n-1}</script> и взять<br>остаток от деления результата на <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">M</script>. Например, это можно сделать при помощи следующей функции за время, пропорциональное длине строки:<br><br></p>
<div class="page_code_style">
<p>const int BASE = 27;<br>const int M = 1000000007;<br><br>int get_hash(string &amp; s)<br>{<br>&nbsp;&nbsp;&nbsp; int result = 0;<br>&nbsp;&nbsp;&nbsp; for (auto c: S) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = ((long long)result * BASE + c - 'a' + 1) % M;<br>&nbsp;&nbsp;&nbsp; return result<br>}</p>
</div>
<p><br>Если же в конец данной строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.194ex" viewBox="0 -817.1 645.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">S</script> добавить строку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.048ex" viewBox="0 -754.4 704.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">T</script> длиной в <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.611ex" viewBox="0 -566.3 878.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">m</script> символов, то число, соответствующее хеш-функции строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.194ex" viewBox="0 -817.1 645.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">S</script> необходимо сдвинуть на <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.611ex" viewBox="0 -566.3 878.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">m</script> символов влево, что соответствует умножению на <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>b</mi><mi>m</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.673ex" height="2.194ex" viewBox="0 -817.1 1150.7 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="607" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mi>m</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-43">b^m</script>, после чего добавить хеш-функцию строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.048ex" viewBox="0 -754.4 704.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">T</script>.<br><br></p><div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mi>m</mi></msup><mo>+</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.26ex" height="2.776ex" viewBox="0 -817.1 14750.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMATHI-54" x="1611" y="0"></use><use xlink:href="#MJMAIN-29" x="2316" y="0"></use><use xlink:href="#MJMAIN-3D" x="2983" y="0"></use><g transform="translate(4039,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMAIN-29" x="1611" y="0"></use><g transform="translate(2001,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="607" y="513"></use></g><use xlink:href="#MJMAIN-2B" x="3373" y="0"></use><use xlink:href="#MJMATHI-68" x="4374" y="0"></use><use xlink:href="#MJMAIN-28" x="4951" y="0"></use><use xlink:href="#MJMATHI-54" x="5340" y="0"></use><use xlink:href="#MJMAIN-29" x="6045" y="0"></use></g><use xlink:href="#MJMAIN-29" x="6824" y="0"></use></g><g transform="translate(11530,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="13699" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><msup><mi>b</mi><mi>m</mi></msup><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-45"> h(ST) = \left(h(S)b^m + h(T)\right) \bmod M </script></p></div><p><br><br>То есть легко вычислить хеш-функцию от конкатенации двух строк <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.194ex" viewBox="0 -817.1 645.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">S</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.048ex" viewBox="0 -754.4 704.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">T</script>, если известны хеш-функции от данных строк.<br><br>С другой стороны, пусть известна хеш-функция <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.284ex" height="2.776ex" viewBox="0 -817.1 2705.5 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMATHI-54" x="1611" y="0"></use><use xlink:href="#MJMAIN-29" x="2316" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mi>T</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">h(ST)</script> и хеш-функция от ее префикса <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.648ex" height="2.776ex" viewBox="0 -817.1 2001 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMAIN-29" x="1611" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">h(S)</script>. Тогда можно вычислить хеш-функцию от строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.048ex" viewBox="0 -754.4 704.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">T</script>:<br></p><div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mi>m</mi></msup></mrow><mo>)</mo></mrow><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.26ex" height="2.776ex" viewBox="0 -817.1 14750.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-54" x="966" y="0"></use><use xlink:href="#MJMAIN-29" x="1670" y="0"></use><use xlink:href="#MJMAIN-3D" x="2337" y="0"></use><g transform="translate(3394,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMATHI-54" x="1611" y="0"></use><use xlink:href="#MJMAIN-29" x="2316" y="0"></use><use xlink:href="#MJMAIN-2212" x="2927" y="0"></use><use xlink:href="#MJMATHI-68" x="3928" y="0"></use><use xlink:href="#MJMAIN-28" x="4504" y="0"></use><use xlink:href="#MJMATHI-53" x="4894" y="0"></use><use xlink:href="#MJMAIN-29" x="5539" y="0"></use><g transform="translate(5929,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="607" y="513"></use></g></g><use xlink:href="#MJMAIN-29" x="7469" y="0"></use></g><g transform="translate(11530,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="13699" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mi>T</mi><mo stretchy="false">)</mo><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><msup><mi>b</mi><mi>m</mi></msup></mrow><mo>)</mo></mrow><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-51"> h(T) = \left(h(ST)- h(S)b^m\right) \bmod M </script></p></div><p><br><br>Таким образом, если дана строка <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.194ex" viewBox="0 -817.1 645.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">S</script> и необходимо вычислить хеш-функцию от подстроки этой строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.621ex" height="2.776ex" viewBox="0 -817.1 2850.8 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="645" y="0"></use><use xlink:href="#MJMATHI-69" x="924" y="0"></use><use xlink:href="#MJMAIN-2E" x="1269" y="0"></use><use xlink:href="#MJMAIN-2E" x="1714" y="0"></use><use xlink:href="#MJMATHI-6A" x="2159" y="0"></use><use xlink:href="#MJMAIN-5D" x="2572" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">S[i..j]</script> (то есть от подстроки из символов от <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">i</script> до <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">j</script> длиной <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mi>i</mi><mo>+</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.63ex" height="2.485ex" viewBox="-11.5 -754.4 3715.9 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="634" y="0"></use><use xlink:href="#MJMATHI-69" x="1635" y="0"></use><use xlink:href="#MJMAIN-2B" x="2203" y="0"></use><use xlink:href="#MJMAIN-31" x="3203" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-56">j-i+1</script>), то это можно сделать, зная значения хеш-функции от префиксов строки длины <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.805ex" height="2.194ex" viewBox="0 -754.4 2068.9 944.5" role="img" focusable="false" style="vertical-align: -0.442ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use><use xlink:href="#MJMAIN-2212" x="567" y="0"></use><use xlink:href="#MJMAIN-31" x="1568" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-57">i-1</script> и <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">j</script>:<br><br></p><div style="text-align:center"><p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1..</mn><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>h</mi><mo stretchy=&quot;false&quot;>(</mo><mi>S</mi><mo stretchy=&quot;false&quot;>[</mo><mn>1..</mn><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo><msup><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>&amp;#x2212;</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo>)</mo></mrow><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.526ex" height="3.213ex" viewBox="0 -942.5 21754.2 1383.4" role="img" focusable="false" style="vertical-align: -1.024ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMAIN-5B" x="1611" y="0"></use><use xlink:href="#MJMATHI-69" x="1890" y="0"></use><use xlink:href="#MJMAIN-2E" x="2235" y="0"></use><use xlink:href="#MJMAIN-2E" x="2680" y="0"></use><use xlink:href="#MJMATHI-6A" x="3125" y="0"></use><use xlink:href="#MJMAIN-5D" x="3538" y="0"></use><use xlink:href="#MJMAIN-29" x="3816" y="0"></use><use xlink:href="#MJMAIN-3D" x="4484" y="0"></use><g transform="translate(5540,0)"><use xlink:href="#MJSZ1-28"></use><g transform="translate(458,0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="576" y="0"></use><use xlink:href="#MJMATHI-53" x="966" y="0"></use><use xlink:href="#MJMAIN-5B" x="1611" y="0"></use><g transform="translate(1890,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-2E" x="779" y="0"></use></g><use xlink:href="#MJMATHI-6A" x="2947" y="0"></use><use xlink:href="#MJMAIN-5D" x="3360" y="0"></use><use xlink:href="#MJMAIN-29" x="3638" y="0"></use><use xlink:href="#MJMAIN-2212" x="4250" y="0"></use><use xlink:href="#MJMATHI-68" x="5250" y="0"></use><use xlink:href="#MJMAIN-28" x="5827" y="0"></use><use xlink:href="#MJMATHI-53" x="6216" y="0"></use><use xlink:href="#MJMAIN-5B" x="6862" y="0"></use><g transform="translate(7140,0)"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xlink:href="#MJMAIN-2E" x="779" y="0"></use></g><use xlink:href="#MJMATHI-6A" x="8198" y="0"></use><use xlink:href="#MJMAIN-5D" x="8610" y="0"></use><use xlink:href="#MJMAIN-29" x="8889" y="0"></use><g transform="translate(9278,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><g transform="translate(429,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1191" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="1536" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="2315" y="0"></use></g></g></g><use xlink:href="#MJSZ1-29" x="12257" y="-1"></use></g><g transform="translate(18534,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="20702" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>(</mo><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo>)</mo></mrow><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-59"> h(S[i..j]) = \left(h(S[1..j])- h(S[1..j])b^{j - i+1}\right) \bmod M </script></p></div><p><br><br>То есть если известны значения хеш-функции на всех префиксах данной строки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.194ex" viewBox="0 -817.1 645.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">S</script>, то значение хеш-функции от любой ее подстроки можно вычислить за <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.776ex" viewBox="0 -817.1 2043 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMAIN-31" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">O(1)</script>, если также известно значение <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>b</mi><mi>m</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.796ex" height="2.194ex" viewBox="0 -817.1 4648.2 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="607" y="513"></use><g transform="translate(1428,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="3596" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mi>m</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">b^m\bmod M</script>. Это можно сделать при помощи следующей функции:</p>
<div class="page_code_style">int get_hash(int i, int j, int * prefix, int * power) {<br>&nbsp;&nbsp;&nbsp; return (prefix[j] - (long long)prefix[i-1] * power[j-i+1] % M + M) % M;<br>}</div>
<p><br>Эта функция получает на вход следующие параметры: границы подстроки i и j и два массива prefix и power. Сама строка S не передается в функцию, вместо нее передаются указанные массивы. В массиве prefix хранятся значения хеш-функции для всех префиксов строки S, то есть значение prefix[i] равно значению хеш-функции для префикcа S[1..i] строки S. В списке [ower хранятся значения степеней числа <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.194ex" viewBox="0 -817.1 429.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">b</script> по модулю <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.048ex" viewBox="0 -754.4 1051.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">M</script>, то есть <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><msup><mi>b</mi><mi>i</mi></msup><mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;>mod</mo><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.298ex" height="3.068ex" viewBox="-38.5 -942.5 9169.9 1320.7" role="img" focusable="false" style="vertical-align: -0.878ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70" x="0" y="0"></use><use xlink:href="#MJMATHI-6F" x="503" y="0"></use><use xlink:href="#MJMATHI-77" x="989" y="0"></use><use xlink:href="#MJMATHI-65" x="1705" y="0"></use><use xlink:href="#MJMATHI-72" x="2172" y="0"></use><use xlink:href="#MJMAIN-5B" x="2623" y="0"></use><use xlink:href="#MJMATHI-69" x="2902" y="0"></use><use xlink:href="#MJMAIN-5D" x="3247" y="0"></use><use xlink:href="#MJMAIN-3D" x="3803" y="0"></use><g transform="translate(4860,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="607" y="513"></use></g><g transform="translate(5911,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-6F" x="833" y="0"></use><use xlink:href="#MJMAIN-64" x="1334" y="0"></use></g><use xlink:href="#MJMATHI-4D" x="8079" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><msup><mi>b</mi><mi>i</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">power[i]=b^i\bmod M</script>.</p>
<p>В языке C++ удобно считать, что символы строки нумеруются начиная с 1, то есть строка состоит из символов <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x2026;</mo><msub><mi>s</mi><mi>n</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.096ex" height="1.902ex" viewBox="0 -566.3 4346.8 819.1" role="img" focusable="false" style="vertical-align: -0.587ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use><g transform="translate(923,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use></g><use xlink:href="#MJMAIN-2026" x="2013" y="0"></use><g transform="translate(3352,0)"><use xlink:href="#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="663" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>…</mo><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-66">s_1s_2…s_n</script>, тогда <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>r</mi><mi>e</mi><mi>f</mi><mi>i</mi><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.519ex" height="2.776ex" viewBox="-38.5 -817.1 5820.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-70" x="0" y="0"></use><use xlink:href="#MJMATHI-72" x="503" y="0"></use><use xlink:href="#MJMATHI-65" x="955" y="0"></use><use xlink:href="#MJMATHI-66" x="1421" y="0"></use><use xlink:href="#MJMATHI-69" x="1972" y="0"></use><use xlink:href="#MJMATHI-78" x="2317" y="0"></use><use xlink:href="#MJMAIN-5B" x="2890" y="0"></use><use xlink:href="#MJMAIN-30" x="3168" y="0"></use><use xlink:href="#MJMAIN-5D" x="3669" y="0"></use><use xlink:href="#MJMAIN-3D" x="4225" y="0"></use><use xlink:href="#MJMAIN-30" x="5281" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi><mi>f</mi><mi>i</mi><mi>x</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-67">prefix[0] = 0</script> и соответствует хеш-функции пустой строки.<br><br>Значения массивов&nbsp; prefix и power необходимо вычислить один раз в начале, выполнив так называемый ``предподсчет'', то есть предварительную подготовку, необходимую для реализации алгоритма. Для выполнения предподсчета используются две функции: функция calc_prefix получает на вход строку S и заполняет массив prefix, содержащий значение хеш-функции для всех префиксов строки S, и функция calc_power, получающая на вход число <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">n</script> и заполняющая массив power.</p>
<div class="page_code_style">const int BASE = 27;<br>const int M = 1000000007;<br><br>void calc_prefix(string &amp; s, int * prefix)<br>{<br>&nbsp;&nbsp;&nbsp; int n = s.size();<br>&nbsp;&nbsp;&nbsp; prefix[0] = 0;<br>&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; n; ++i)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prefix[i+1] = ((long long)prefix[i] * BASE + s[i] - 'a' + 1) % M;<br>}<br><br>void calc_power(int n, int * power)<br>{<br>&nbsp;&nbsp;&nbsp; power[0] = 1;<br>&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; n; ++i)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; power[i+1] = (long long) power[i] * BASE % M;<br>}</div>
<p><br>Предподсчет выполняется за время <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.977ex" height="2.776ex" viewBox="0 -817.1 2143 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMATHI-6E" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1753" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">O(n)</script>, но после однократно выполненного предподсчета<br>функция get_hash позволяет за <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.776ex" viewBox="0 -817.1 2043 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4F" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="763" y="0"></use><use xlink:href="#MJMAIN-31" x="1153" y="0"></use><use xlink:href="#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">O(1)</script> вычислять значение хеш-функции для любой подстроки<br>данной строки, что позволяет, например, быстро проверять на равенство две подстроки.<br><br></p></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>