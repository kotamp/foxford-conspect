<!doctype html>
<html><head><link rel="stylesheet" href="../page.css"><title>13. Двумерное динамическое программирование: таблицы</title></head><body><h1>13. Двумерное динамическое программирование: таблицы</h1>
<div class="page_content_main"><p>В этом разделе будут рассматриваться задачи, похожие на задачи из раздела Одномерное динамическое программирование, но вместо одномерных задач на движение по прямой будут рассматриваться перемещения в двумерном пространстве — например, перемещения на шахматной доске или на клетчатом листе бумаги</p>
<h2>Подсчет числа маршрутов</h2>
<p>Рассмотрим шахматную доску в левом верхнем углу которой находится король. Король может перемещаться только вправо, вниз или по диагонали вправо-вниз на одну клетку. Необходимо определить количество различных маршрутов короля, приводящих его в правый нижний угол.</p>
<p>Сопоставим каждой клетке ее координаты <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.776ex" viewBox="0 -817.1 1982.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(i, j)</script>, где <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.048ex" viewBox="0 -754.4 345.5 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">i</script> будет обозначать номер строки на доске, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.485ex" viewBox="-11.5 -754.4 424 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">j</script> — номер столбца. Нумеровать строки будем сверху вниз, столбцы — слева направо, нумерация начинается с 0. Тогда начальное положение короля будет клетка <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.776ex" viewBox="0 -817.1 2225.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMAIN-30" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="890" y="0"></use><use xlink:href="#MJMAIN-30" x="1335" y="0"></use><use xlink:href="#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">(0, 0)</script>.</p>
<p>Обозначим через <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.345ex" height="2.776ex" viewBox="0 -817.1 2731.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">F(i, j)</script> количество способов прийти из клетки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.776ex" viewBox="0 -817.1 2225.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMAIN-30" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="890" y="0"></use><use xlink:href="#MJMAIN-30" x="1335" y="0"></use><use xlink:href="#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">(0, 0)</script> в клетку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.776ex" viewBox="0 -817.1 1982.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">(i, j)</script>. В клетку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.776ex" viewBox="0 -817.1 1982.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">(i, j)</script> можно прийти из трех клеток — слева из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.607ex" height="2.776ex" viewBox="0 -817.1 3705.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-2212" x="1814" y="0"></use><use xlink:href="#MJMAIN-31" x="2815" y="0"></use><use xlink:href="#MJMAIN-29" x="3316" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">(i, j -1)</script>, сверху из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.607ex" height="2.776ex" viewBox="0 -817.1 3705.6 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2212" x="957" y="0"></use><use xlink:href="#MJMAIN-31" x="1957" y="0"></use><use xlink:href="#MJMAIN-2C" x="2458" y="0"></use><use xlink:href="#MJMATHI-6A" x="2903" y="0"></use><use xlink:href="#MJMAIN-29" x="3316" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">(i-1, j)</script> и по диагонали из <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.609ex" height="2.776ex" viewBox="0 -817.1 5429.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2212" x="957" y="0"></use><use xlink:href="#MJMAIN-31" x="1957" y="0"></use><use xlink:href="#MJMAIN-2C" x="2458" y="0"></use><use xlink:href="#MJMATHI-6A" x="2903" y="0"></use><use xlink:href="#MJMAIN-2212" x="3538" y="0"></use><use xlink:href="#MJMAIN-31" x="4539" y="0"></use><use xlink:href="#MJMAIN-29" x="5039" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">(i-1, j - 1)</script>. Поэтому число маршрутов ведущих в клетку равно числу маршрутов из всех ее предшественников, а именно:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.169ex" height="2.776ex" viewBox="0 -817.1 21600.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use><use xlink:href="#MJMAIN-3D" x="3009" y="0"></use><use xlink:href="#MJMATHI-46" x="4065" y="0"></use><use xlink:href="#MJMAIN-28" x="4815" y="0"></use><use xlink:href="#MJMATHI-69" x="5204" y="0"></use><use xlink:href="#MJMAIN-2C" x="5550" y="0"></use><use xlink:href="#MJMATHI-6A" x="5995" y="0"></use><use xlink:href="#MJMAIN-2212" x="6630" y="0"></use><use xlink:href="#MJMAIN-31" x="7630" y="0"></use><use xlink:href="#MJMAIN-29" x="8131" y="0"></use><use xlink:href="#MJMAIN-2B" x="8743" y="0"></use><use xlink:href="#MJMATHI-46" x="9743" y="0"></use><use xlink:href="#MJMAIN-28" x="10493" y="0"></use><use xlink:href="#MJMATHI-69" x="10882" y="0"></use><use xlink:href="#MJMAIN-2212" x="11450" y="0"></use><use xlink:href="#MJMAIN-31" x="12451" y="0"></use><use xlink:href="#MJMAIN-2C" x="12951" y="0"></use><use xlink:href="#MJMATHI-6A" x="13396" y="0"></use><use xlink:href="#MJMAIN-29" x="13809" y="0"></use><use xlink:href="#MJMAIN-2B" x="14421" y="0"></use><use xlink:href="#MJMATHI-46" x="15421" y="0"></use><use xlink:href="#MJMAIN-28" x="16171" y="0"></use><use xlink:href="#MJMATHI-69" x="16560" y="0"></use><use xlink:href="#MJMAIN-2212" x="17128" y="0"></use><use xlink:href="#MJMAIN-31" x="18129" y="0"></use><use xlink:href="#MJMAIN-2C" x="18629" y="0"></use><use xlink:href="#MJMATHI-6A" x="19074" y="0"></use><use xlink:href="#MJMAIN-2212" x="19709" y="0"></use><use xlink:href="#MJMAIN-31" x="20710" y="0"></use><use xlink:href="#MJMAIN-29" x="21210" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">F(i, j) = F(i, j - 1) + F(i - 1, j) + F(i - 1, j - 1)</script>&nbsp;</p>
<p>Отдельно нужно задать значения для граничных клеток, то есть когда <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.063ex" height="2.048ex" viewBox="0 -754.4 2180.1 881.8" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-69" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="623" y="0"></use><use xlink:href="#MJMAIN-30" x="1679" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-13">i=0</script> или <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>j</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.246ex" height="2.485ex" viewBox="-11.5 -754.4 2258.6 1069.9" role="img" focusable="false" style="vertical-align: -0.733ex; margin-left: -0.027ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"></use><use xlink:href="#MJMAIN-3D" x="690" y="0"></use><use xlink:href="#MJMAIN-30" x="1746" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">j=0</script>. В результате получится таблица заполненная следующим образом:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">1</p>
</td>
</tr>
<tr>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">3</p>
</td>
<td valign="top" width="63">
<p align="center">5</p>
</td>
<td valign="top" width="63">
<p align="center">7</p>
</td>
<td valign="top" width="63">
<p align="center">9</p>
</td>
</tr>
<tr>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">5</p>
</td>
<td valign="top" width="63">
<p align="center">13</p>
</td>
<td valign="top" width="63">
<p align="center">25</p>
</td>
<td valign="top" width="63">
<p align="center">41</p>
</td>
</tr>
<tr>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">7</p>
</td>
<td valign="top" width="63">
<p align="center">25</p>
</td>
<td valign="top" width="63">
<p align="center">63</p>
</td>
<td valign="top" width="63">
<p align="center">129</p>
</td>
</tr>
<tr>
<td valign="top" width="63">
<p align="center">1</p>
</td>
<td valign="top" width="63">
<p align="center">9</p>
</td>
<td valign="top" width="63">
<p align="center">41</p>
</td>
<td valign="top" width="63">
<p align="center">129</p>
</td>
<td valign="top" width="63">
<p align="center">321</p>
</td>
</tr>
</tbody>
</table>
<p>Для заполнения этой таблицы и подсчета числа маршрутов можно использовать следующую программу, в которой сначала создается двумерный список, затем заполняются крайние клетки (первый столбец и первая строка), затем заполняются остальные элементы таблицы при помощи приведенного выше рекуррентного соотношения. В данном примере <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.611ex" viewBox="0 -566.3 600.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">n</script> - число строк, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.611ex" viewBox="0 -566.3 878.5 693.7" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">m</script> - число столбцов на доске.</p>
<div class="page_code_style">
<p>F = [[0] * m for i in range(n)]<br>for i in range(n):<br> &nbsp; &nbsp;F[i][0] = 1<br>for j in range(m):<br> &nbsp; &nbsp;F[0][j] = 1<br>for i in range(1, n):<br> &nbsp; &nbsp;for j in range(1, m):<br> &nbsp; &nbsp; &nbsp; &nbsp;F[i][j] = F[i][j - 1] + F[i - 1][j] + F[i - 1][j - 1]</p>
</div>
<p>На этом примере можно составить общий план решения задачи методом динамического программирования. Этот план можно использовать для решения любых задач при помощи динамического программирования:</p>
<ol>
<li>&nbsp;Записать то, что требуется найти в задаче, как целевую функцию от некоторого набора аргументов (числовых, строковых или еще каких-либо).&nbsp;</li>
<li>&nbsp;Свести решение задачи для произвольного набора параметров к решению аналогичных подзадач для других наборов параметров (как правило, с меньшими значениями параметров). Если задача несложная, то полезно бывает выписать явное рекуррентное соотношение, задающее значение функции для данного набора параметров.&nbsp;</li>
<li>&nbsp;Задать начальные значения функции, то есть те наборы аргументов, при которых задача тривиальна и можно явно указать значение функции.&nbsp;</li>
<li>&nbsp;Создать массив (или другую структуру данных) для хранения значений функции. Как правило, если функция зависит от одного целочисленного параметра, то используется одномерный массив, для функции от двух целочисленных параметров — двумерный массив и т. д.&nbsp;</li>
<li>&nbsp;Организовать заполнение массива с начальных значений, определяя очередной элемент массива при помощи выписанного на шаге 2 рекуррентного соотношения или алгоритма.&nbsp;</li>
</ol>
<p>Для заполнения первой строки и первого столбца таблицы мы использовали «специальную» формулу, отличающуюся от общего случая. Но в некоторых задачах удобней бывает все значения вычислять по одной и той же формуле, а для граничных значений функции ввести специальные «фиктивные» элементы. В данной задаче тоже можно так поступить — введем специальную «каемочку» из одного фиктивного столбца слева и одной фиктивной строки сверху таблицы.</p>
<p>Для того, чтобы значения в остальной таблице вычислялись по общим формулам, во все клетки каемочки нужно записать число 0, кроме клетки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.776ex" viewBox="0 -817.1 2225.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMAIN-30" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="890" y="0"></use><use xlink:href="#MJMAIN-30" x="1335" y="0"></use><use xlink:href="#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">(0, 0)</script>, в которую будет записано значение 1:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="53">
<p align="center">0</p>
</td>
</tr>
<tr>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="53">
<p align="center">1</p>
</td>
</tr>
<tr>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">3</p>
</td>
<td valign="top" width="52">
<p align="center">5</p>
</td>
<td valign="top" width="52">
<p align="center">7</p>
</td>
<td valign="top" width="53">
<p align="center">9</p>
</td>
</tr>
<tr>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">5</p>
</td>
<td valign="top" width="52">
<p align="center">13</p>
</td>
<td valign="top" width="52">
<p align="center">25</p>
</td>
<td valign="top" width="53">
<p align="center">41</p>
</td>
</tr>
<tr>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">7</p>
</td>
<td valign="top" width="52">
<p align="center">25</p>
</td>
<td valign="top" width="52">
<p align="center">63</p>
</td>
<td valign="top" width="53">
<p align="center">129</p>
</td>
</tr>
<tr>
<td valign="top" width="52">
<p align="center">0</p>
</td>
<td valign="top" width="52">
<p align="center">1</p>
</td>
<td valign="top" width="52">
<p align="center">9</p>
</td>
<td valign="top" width="52">
<p align="center">41</p>
</td>
<td valign="top" width="52">
<p align="center">129</p>
</td>
<td valign="top" width="53">
<p align="center">321</p>
</td>
</tr>
</tbody>
</table>
<p>Теперь во всех остальных клетках таблицы значения могут быть вычислены по общей формуле: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.169ex" height="2.776ex" viewBox="0 -817.1 21600.4 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-46" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="749" y="0"></use><use xlink:href="#MJMATHI-69" x="1139" y="0"></use><use xlink:href="#MJMAIN-2C" x="1484" y="0"></use><use xlink:href="#MJMATHI-6A" x="1929" y="0"></use><use xlink:href="#MJMAIN-29" x="2342" y="0"></use><use xlink:href="#MJMAIN-3D" x="3009" y="0"></use><use xlink:href="#MJMATHI-46" x="4065" y="0"></use><use xlink:href="#MJMAIN-28" x="4815" y="0"></use><use xlink:href="#MJMATHI-69" x="5204" y="0"></use><use xlink:href="#MJMAIN-2C" x="5550" y="0"></use><use xlink:href="#MJMATHI-6A" x="5995" y="0"></use><use xlink:href="#MJMAIN-2212" x="6630" y="0"></use><use xlink:href="#MJMAIN-31" x="7630" y="0"></use><use xlink:href="#MJMAIN-29" x="8131" y="0"></use><use xlink:href="#MJMAIN-2B" x="8743" y="0"></use><use xlink:href="#MJMATHI-46" x="9743" y="0"></use><use xlink:href="#MJMAIN-28" x="10493" y="0"></use><use xlink:href="#MJMATHI-69" x="10882" y="0"></use><use xlink:href="#MJMAIN-2212" x="11450" y="0"></use><use xlink:href="#MJMAIN-31" x="12451" y="0"></use><use xlink:href="#MJMAIN-2C" x="12951" y="0"></use><use xlink:href="#MJMATHI-6A" x="13396" y="0"></use><use xlink:href="#MJMAIN-29" x="13809" y="0"></use><use xlink:href="#MJMAIN-2B" x="14421" y="0"></use><use xlink:href="#MJMATHI-46" x="15421" y="0"></use><use xlink:href="#MJMAIN-28" x="16171" y="0"></use><use xlink:href="#MJMATHI-69" x="16560" y="0"></use><use xlink:href="#MJMAIN-2212" x="17128" y="0"></use><use xlink:href="#MJMAIN-31" x="18129" y="0"></use><use xlink:href="#MJMAIN-2C" x="18629" y="0"></use><use xlink:href="#MJMATHI-6A" x="19074" y="0"></use><use xlink:href="#MJMAIN-2212" x="19709" y="0"></use><use xlink:href="#MJMAIN-31" x="20710" y="0"></use><use xlink:href="#MJMAIN-29" x="21210" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">F(i, j) = F(i, j - 1) + F(i - 1, j) + F(i - 1, j - 1)</script>, а программа может выглядеть так:</p>
<div class="page_code_style">
<p>F = [[0] * (m + 1)&nbsp;for i in range(n + 1)]<br>F[0][0] = 1<br>for i in range(1, n + 1):<br> &nbsp; &nbsp;for j in range(1, m + 1):<br> &nbsp; &nbsp; &nbsp; &nbsp;F[i][j] = F[i][j - 1] + F[i - 1][j] + F[i - 1][j — 1]</p>
</div>
<h2>Маршрут наименьшей стоимости</h2>
<p>Теперь решим задачу о нахождении маршрута минимальной стоимости из левого верхнего угла в правый нижний, считая что для каждой клетке указана стоимость прохода через эту клетку. Сразу же будем считать, что таблица снабжена «каемочкой», поэтому начальная клетка будет иметь индексы <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.776ex" viewBox="0 -817.1 2225.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMAIN-31" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="890" y="0"></use><use xlink:href="#MJMAIN-31" x="1335" y="0"></use><use xlink:href="#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">(1, 1)</script>, конечная клетка — <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>,</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.278ex" height="2.776ex" viewBox="0 -817.1 2703.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-6E" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="990" y="0"></use><use xlink:href="#MJMATHI-6D" x="1435" y="0"></use><use xlink:href="#MJMAIN-29" x="2313" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">(n, m)</script>, а строка и столбец с индексом 0 будут относится к фиктивной каемочке.</p>
<p>Если считать, что стоимость прохода через клетку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.776ex" viewBox="0 -817.1 1982.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">(i, j)</script> записана в отдельном списке <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.775ex" height="2.776ex" viewBox="0 -817.1 4208.7 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-50" x="0" y="0"></use><use xlink:href="#MJMATHI-72" x="751" y="0"></use><use xlink:href="#MJMATHI-69" x="1203" y="0"></use><use xlink:href="#MJMATHI-63" x="1548" y="0"></use><use xlink:href="#MJMATHI-65" x="1982" y="0"></use><use xlink:href="#MJMAIN-5B" x="2448" y="0"></use><use xlink:href="#MJMATHI-69" x="2727" y="0"></use><use xlink:href="#MJMAIN-2C" x="3072" y="0"></use><use xlink:href="#MJMATHI-6A" x="3517" y="0"></use><use xlink:href="#MJMAIN-5D" x="3930" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">Price[i, j]</script>, то обозначив через <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x421;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.06ex" height="2.776ex" viewBox="0 -817.1 2609.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(62.702) matrix(1 0 0 -1 0 0)">С</text><use xlink:href="#MJMAIN-28" x="627" y="0"></use><use xlink:href="#MJMATHI-69" x="1016" y="0"></use><use xlink:href="#MJMAIN-2C" x="1362" y="0"></use><use xlink:href="#MJMATHI-6A" x="1807" y="0"></use><use xlink:href="#MJMAIN-29" x="2219" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>С</mo></mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">С(i, j)</script> стоимость кратчайшего пути из начальной клетки <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.776ex" viewBox="0 -817.1 2225.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMAIN-31" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="890" y="0"></use><use xlink:href="#MJMAIN-31" x="1335" y="0"></use><use xlink:href="#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">(1, 1)</script> в клетку <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.776ex" viewBox="0 -817.1 1982.2 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-69" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="735" y="0"></use><use xlink:href="#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">(i, j)</script> получим рекуррентное соотношение: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.958ex" height="2.776ex" viewBox="0 -817.1 27967.9 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-28" x="760" y="0"></use><use xlink:href="#MJMATHI-69" x="1150" y="0"></use><use xlink:href="#MJMAIN-2C" x="1495" y="0"></use><use xlink:href="#MJMATHI-6A" x="1940" y="0"></use><use xlink:href="#MJMAIN-29" x="2353" y="0"></use><use xlink:href="#MJMAIN-3D" x="3020" y="0"></use><g transform="translate(4076,0)"><use xlink:href="#MJMAIN-6D"></use><use xlink:href="#MJMAIN-69" x="833" y="0"></use><use xlink:href="#MJMAIN-6E" x="1112" y="0"></use></g><use xlink:href="#MJMAIN-28" x="5745" y="0"></use><use xlink:href="#MJMATHI-43" x="6134" y="0"></use><use xlink:href="#MJMAIN-28" x="6895" y="0"></use><use xlink:href="#MJMATHI-69" x="7284" y="0"></use><use xlink:href="#MJMAIN-2C" x="7630" y="0"></use><use xlink:href="#MJMATHI-6A" x="8075" y="0"></use><use xlink:href="#MJMAIN-2212" x="8710" y="0"></use><use xlink:href="#MJMAIN-31" x="9710" y="0"></use><use xlink:href="#MJMAIN-29" x="10211" y="0"></use><use xlink:href="#MJMAIN-2C" x="10600" y="0"></use><use xlink:href="#MJMATHI-43" x="11046" y="0"></use><use xlink:href="#MJMAIN-28" x="11806" y="0"></use><use xlink:href="#MJMATHI-69" x="12196" y="0"></use><use xlink:href="#MJMAIN-2212" x="12763" y="0"></use><use xlink:href="#MJMAIN-31" x="13764" y="0"></use><use xlink:href="#MJMAIN-2C" x="14264" y="0"></use><use xlink:href="#MJMATHI-6A" x="14710" y="0"></use><use xlink:href="#MJMAIN-29" x="15122" y="0"></use><use xlink:href="#MJMAIN-2C" x="15512" y="0"></use><use xlink:href="#MJMATHI-43" x="15957" y="0"></use><use xlink:href="#MJMAIN-28" x="16717" y="0"></use><use xlink:href="#MJMATHI-69" x="17107" y="0"></use><use xlink:href="#MJMAIN-2212" x="17675" y="0"></use><use xlink:href="#MJMAIN-31" x="18675" y="0"></use><use xlink:href="#MJMAIN-2C" x="19176" y="0"></use><use xlink:href="#MJMATHI-6A" x="19621" y="0"></use><use xlink:href="#MJMAIN-2212" x="20256" y="0"></use><use xlink:href="#MJMAIN-31" x="21256" y="0"></use><use xlink:href="#MJMAIN-29" x="21757" y="0"></use><use xlink:href="#MJMAIN-29" x="22146" y="0"></use><use xlink:href="#MJMAIN-2B" x="22758" y="0"></use><use xlink:href="#MJMATHI-50" x="23759" y="0"></use><use xlink:href="#MJMATHI-72" x="24510" y="0"></use><use xlink:href="#MJMATHI-69" x="24962" y="0"></use><use xlink:href="#MJMATHI-63" x="25307" y="0"></use><use xlink:href="#MJMATHI-65" x="25741" y="0"></use><use xlink:href="#MJMAIN-5B" x="26207" y="0"></use><use xlink:href="#MJMATHI-69" x="26486" y="0"></use><use xlink:href="#MJMAIN-2C" x="26831" y="0"></use><use xlink:href="#MJMATHI-6A" x="27276" y="0"></use><use xlink:href="#MJMAIN-5D" x="27689" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">min</mo><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>P</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>e</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">C(i, j) = \min(C(i, j - 1), C(i - 1, j), C(i - 1, j - 1)) + Price[i, j]</script></p>
<p>При этом при вычислении граничных значений (в первом столбце и первой строке) необходимо учитывать только клетки из этого столбца и этой строки (но не из предыдущего столбца и предыдущей строки). Это удобно реализовать, если заполнить предыдущую строк и предыдущий столбец «каемочкой», записав для клеток каемочки значения функции <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.194ex" viewBox="0 -817.1 760.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">C</script> равными некоторому очень большому числу. Это число мы будем обозначать как INF, в качестве значения INF следует взять число, заведомо больше, чем максимальное число, которое может быть записано в таблице <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.194ex" viewBox="0 -817.1 760.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">C</script>. А в угол «каемочки» нужно записать число 0: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.94ex" height="2.776ex" viewBox="0 -817.1 4710.1 1195.3" role="img" focusable="false" style="vertical-align: -0.878ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><use xlink:href="#MJMAIN-5B" x="760" y="0"></use><use xlink:href="#MJMAIN-30" x="1039" y="0"></use><use xlink:href="#MJMAIN-5D" x="1539" y="0"></use><use xlink:href="#MJMAIN-5B" x="1818" y="0"></use><use xlink:href="#MJMAIN-30" x="2096" y="0"></use><use xlink:href="#MJMAIN-5D" x="2597" y="0"></use><use xlink:href="#MJMAIN-3D" x="3153" y="0"></use><use xlink:href="#MJMAIN-30" x="4209" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-29"> C[0 ][0 ]=0 </script>.</p>
<div class="page_code_style">
<p>INF = 10 ** 20<br>C = [[0] * (m + 1) for i in range(n + 1)]<br>C[0][0] = 0<br>for i in range(1, n + 1):<br> &nbsp; &nbsp;C[i][0] = INF<br>for j in range(1, m + 1):<br> &nbsp; &nbsp;C[0][j] = INF<br>for i in range(1, n + 1):<br> &nbsp; &nbsp;for j in range(1, m + 1):<br> &nbsp; &nbsp; &nbsp; &nbsp;C[i][j] = min(C[i][j - 1], C[i - 1][j], C[i - 1][j - 1]) + Price[i][j]</p>
</div>
<h3>Восстановление ответа</h3>
<p>Теперь напишем восстановление ответа. Точно так же, как и в одномерном случае будем идти на конечной клетке в начальную, на каждом шаге выбирая ту из возможных предшествующих клеток, для которой значение функции <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.194ex" viewBox="0 -817.1 760.5 944.5" role="img" focusable="false" style="vertical-align: -0.296ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">C</script> меньше.</p>
<div class="page_code_style">
<p>Answer = []<br>i = n<br>j = m<br>while (i, j) != (0, 0):<br> &nbsp; &nbsp;Answer.append((i, j))<br> &nbsp; &nbsp;prev_C = min(C[i][j - 1], C[i - 1][j], C[i - 1][j - 1])<br> &nbsp; &nbsp;if C[i][j - 1] == prev_C:<br> &nbsp; &nbsp; &nbsp; &nbsp;i, j = i, j - 1<br> &nbsp; &nbsp;elif C[i - 1][j] == prev_C:<br> &nbsp; &nbsp; &nbsp; &nbsp;i, j = i - 1, j<br> &nbsp; &nbsp;else: i, j = i - 1, j - 1<br>Answer = Answer[::-1]</p>
</div>
<h2>&nbsp;</h2></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>